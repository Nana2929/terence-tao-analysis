\section{Local maxima, local minima, and derivatives}\label{sec 10.2}

\begin{definition}[Local maxima and minima]\label{10.2.1}
    Let \(X\) be a subset of \(\mathbf{R}\), and let \(f : X \to \mathbf{R}\) be a function, and let \(x_0 \in X\).
    We say that \(f\) attains a \emph{local maximum} at \(x_0\) iff there exists a \(\delta > 0\) such that the restriction \(f|_{X \cap (x_0 - \delta, x_0 + \delta)}\) of \(f\) to \(X \cap (x_0 - \delta, x_0 + \delta)\) attains a maximum at \(x_0\).
    We say that \(f\) attains a \emph{local minimum} at \(x_0\) iff there exists a \(\delta > 0\) such that the restriction \(f|_{X \cap (x_0 - \delta, x_0 + \delta)}\) of \(f\) to \(X \cap (x_0 - \delta, x_0 + \delta)\) attains a minimum at \(x_0\).
\end{definition}

\begin{remark}\label{10.2.2}
    If \(f\) attains a maximum at \(x_0\), we sometimes say that \(f\) attains a \emph{global} maximum at \(x_0\), in order to distinguish it from the local maxima defined in Definition \ref{10.2.1}.
    Note that if \(f\) attains a global maximum at \(x_0\), then it certainly also attains a local maximum at this \(x_0\), and similarly for minima.
\end{remark}

\setcounter{theorem}{4}
\begin{remark}\label{10.2.5}
    If \(f : X \to \mathbf{R}\) attains a local maximum at a point \(x_0\) in \(X\), and \(Y \subseteq X\) is a subset of \(X\) which contains \(x_0\), then the restriction \(f|_Y : Y \to \mathbf{R}\) also attains a local maximum at \(x_0\).
    Similarly for minima.
\end{remark}

\begin{proposition}[Local extrema are stationary]\label{10.2.6}
    Let \(a < b\) be real numbers, and let \(f : (a, b) \to \mathbf{R}\) be a function.
    If \(x_0 \in (a, b)\), \(f\) is differentiable at \(x_0\), and \(f\) attains either a local maximum or local minimum at \(x_0\), then \(f'(x_0) = 0\).
\end{proposition}

\begin{proof}
    Suppose \(f\) attains local maximum at \(x_0\).
    Then by Definition \ref{10.2.1} we know that
    \[
        \exists\ \delta \in \mathbf{R}^+ : \forall\ x \in (a, b) \cap (x_0 - \delta, x_0 + \delta), f(x) \leq f(x_0).
    \]
    Since \(f\) is differentiable at \(x_0\), by Definition \ref{10.1.1} we know that
    \[
        \lim_{x \to x_0 ; x \in (a, b) \setminus \{x_0\}} \frac{f(x) - f(x_0)}{x - x_0} = f'(x_0)
    \]
    By Definition \ref{9.3.6} we know that \(\forall\ \varepsilon \in \mathbf{R}^+\), \(\exists\ \delta' \in \mathbf{R}^+\) such that
    \[
        \forall\ x \in (a, b) \setminus \{x_0\}, \abs*{x - x_0} < \delta' \implies \abs*{\frac{f(x) - f(x_0)}{x - x_0} - f'(x_0)} \leq \varepsilon.
    \]
    In particular, we have
    \[
        \forall\ x \in (a, b) \cap (x_0, x_0 + \delta), \abs*{x - x_0} < \delta' \implies \abs*{\frac{f(x) - f(x_0)}{x - x_0} - f'(x_0)} \leq \varepsilon
    \]
    and
    \[
        \forall\ x \in (a, b) \cap (x_0 - \delta, x_0), \abs*{x - x_0} < \delta' \implies \abs*{\frac{f(x) - f(x_0)}{x - x_0} - f'(x_0)} \leq \varepsilon.
    \]
    Thus by Definition \ref{9.3.6} we must also have
    \[
        \lim_{x \to x_0 ; x \in (a, b) \cap (x_0, x_0 + \delta)} \frac{f(x) - f(x_0)}{x - x_0} = \lim_{x \to x_0 ; x \in (a, b) \cap (x_0 - \delta, x_0)} \frac{f(x) - f(x_0)}{x - x_0} = f'(x_0).
    \]
    Since
    \begin{align*}
                 & \forall\ x \in (a, b) \cap (x_0, x_0 + \delta)                                                                                       \\
        \implies & f(x) \leq f(x_0)                                                                                                                     \\
        \implies & f(x) - f(x_0) \leq 0                                                                                                                 \\
        \implies & \frac{f(x) - f(x_0)}{x - x_0} \leq 0                                                                                                 \\
        \implies & \lim_{x \to x_0 ; x \in (a, b) \cap (x_0, x_0 + \delta)} \frac{f(x) - f(x_0)}{x - x_0} \leq 0 & \text{(by Proposition \ref{9.3.14})} \\
        \implies & f'(x_0) \leq 0
    \end{align*}
    and
    \begin{align*}
                 & \forall\ x \in (a, b) \cap (x_0 - \delta, x_0)                                                                                        \\
        \implies & f(x) \leq f(x_0)                                                                                                                      \\
        \implies & f(x) - f(x_0) \leq 0                                                                                                                  \\
        \implies & \frac{f(x) - f(x_0)}{x - x_0} \geq 0                                                                                                  \\
        \implies & \lim_{x \to x_0 ; x \in (a, b) \cap (x_0 - \delta, x_0)} \frac{f(x) - f(x_0)}{x - x_0} \geq 0, & \text{(by Proposition \ref{9.3.14})} \\
        \implies & f'(x_0) \geq 0.
    \end{align*}
    we must have \(f'(x_0) = 0\).
    Similar arguments work for the case \(f\) attains local minimum at \(x_0\).
\end{proof}

\begin{note}
    Note that \(f\) must be differentiable for this proposition to work.
    Also, this proposition does not work if the open interval \((a, b)\) is replaced by a closed interval \([a, b]\).
    For instance, the function \(f : [1, 2] \to \mathbf{R}\) defined by \(f(x) \coloneqq x\) has a local maximum at \(x_0 = 2\) and a local minimum \(x_0 = 1\) (in fact, these local extrema are global extrema), but at both points the derivative is \(f'(x_0) = 1\), not \(f'(x_0) = 0\).
    Thus the endpoints of an interval can be local maxima or minima even if the derivative is not zero there.
    Finally, the converse of this proposition is false.
\end{note}

\begin{theorem}[Rolle's theorem]\label{10.2.7}
    Let \(a < b\) be real numbers, and let \(g : [a, b] \to \mathbf{R}\) be a continuous function which is differentiable on \((a, b)\).
    Suppose also that \(g(a) = g(b)\).
    Then there exists an \(x \in (a, b)\) such that \(g'(x) = 0\).
\end{theorem}

\begin{proof}
    Since \(g\) is continuous on \([a, b]\), by Proposition \ref{9.6.7} \(g\) attains its maximum at some point \(x_{\max} \in [a, b]\), and also attains its minimum at some point \(x_{\min} \in [a, b]\).
    If \(x_{\min} \in \{a, b\} \land x_{\max} \in \{a, b\}\), then by Definition \ref{9.6.5} we have \(\forall\ x \in [a, b]\), \(g(x) = g(a) = g(b)\), and by Theorem \ref{10.1.13}(a) we know that \(g'(x) = 0\).
    So suppose that at least one of \(x_{\min}, x_{\max} \notin \{a, b\}\), i.e., \(x_{\min} \in (a, b) \lor x_{\max} \in (a, b)\).
    If \(x_{\min} \in (a, b)\), then by Proposition \ref{10.2.6} we know that \(f'(x_{\min}) = 0\).
    Similarly, if \(x_{\max} \in (a, b)\), then by Proposition \ref{10.2.6} we know that \(f'(x_{\max}) = 0\).
    Thus there exists an \(x \in (a, b)\) such that \(g'(x) = 0\).
\end{proof}

\begin{remark}\label{10.2.8}
    Note that we only assume \(f\) is differentiable on the open interval \((a, b)\), though of course the theorem also holds if we assume \(f\) is differentiable on the closed interval \([a, b]\), since this is larger than \((a, b)\).
\end{remark}

\begin{corollary}[Mean value theorem]\label{10.2.9}
    Let \(a < b\) be real numbers, and let \(f : [a, b] \to \mathbf{R}\) be a function which is continuous on \([a, b]\) and differentiable on \((a, b)\).
    Then there exists an \(x \in (a, b)\) such that \(f'(x) = \frac{f(b) - f(a)}{b - a}\).
\end{corollary}

\begin{proof}
    Let \(g : [a, b] \to \mathbf{R}\) be a function where \(g(x) = f(x) - \frac{f(a) - f(b)}{a - b} x\).
    Since \(a < b\), we know that \(g\) is well-defined.
    Since \(f\) is differentiable on \((a, b)\), we know that
    \begin{align*}
                 & x \text{ is differentiable on } (a, b)                                  & \text{(by Theorem \ref{10.1.13}(b))} \\
        \implies & \frac{f(a) - f(b)}{a - b} x \text{ is differentiable on } (a, b)        & \text{(by Theorem \ref{10.1.13}(e))} \\
        \implies & f(x) - \frac{f(a) - f(b)}{a - b} x \text{ is differentiable on } (a, b) & \text{(by Theorem \ref{10.1.13}(f))} \\
        \implies & g(x) \text{ is differentiable on } (a, b)                                                                      \\
        \implies & g'(x) = f'(x) - \frac{f(a) - f(b)}{a - b}.
    \end{align*}
    Since
    \[
        g(a) = f(a) - \frac{f(a) - f(b)}{a - b} a = \frac{af(a) - bf(a) - af(a) + af(b)}{a - b} = \frac{af(b) - bf(a)}{a - b}
    \]
    and
    \[
        g(b) = f(b) - \frac{f(a) - f(b)}{a - b} b = \frac{af(b) - bf(b) - bf(a) + bf(b)}{a - b} = \frac{af(b) - bf(a)}{a - b},
    \]
    we have \(g(a) = g(b)\) and by Theorem \ref{10.2.7} \(\exists\ x_0 \in (a, b)\) such that \(g'(x_0) = 0\).
    Thus
    \begin{align*}
                 & g'(x_0) = 0                             \\
        \implies & f'(x_0) - \frac{f(a) - f(b)}{a - b} = 0 \\
        \implies & f'(x_0) = \frac{f(a) - f(b)}{a - b}.
    \end{align*}
\end{proof}

\exercisesection

\begin{exercise}\label{ex 10.2.1}
    Prove Proposition \ref{10.2.6}.
\end{exercise}

\begin{proof}
    See Proposition \ref{10.2.6}.
\end{proof}

\begin{exercise}\label{ex 10.2.2}
    Give an example of a function \(f : (-1, 1) \to \mathbf{R}\) which is continuous and attains a global maximum at \(0\), but which is not differentiable at \(0\).
    Explain why this does not contradict Proposition \ref{10.2.6}.
\end{exercise}

\begin{exercise}\label{ex 10.2.3}
    Give an example of a function \(f : (-1, 1) \to \mathbf{R}\) which is differentiable, and whose derivative equals \(0\) at \(0\), but such that \(0\) is neither a local minimum nor a local maximum.
    Explain why this does not contradict Proposition \ref{10.2.6}.
\end{exercise}

\begin{exercise}\label{ex 10.2.4}
    Prove Theorem \ref{10.2.7}.
\end{exercise}

\begin{proof}
    See Theorem \ref{10.2.7}.
\end{proof}

\begin{exercise}\label{ex 10.2.5}
    Use Theorem \ref{10.2.7} to prove Corollary \ref{10.2.9}.
\end{exercise}

\begin{proof}
    See Corollary \ref{10.2.9}.
\end{proof}

\begin{exercise}\label{ex 10.2.6}
    Let \(M > 0\), and let \(f : [a, b] \to \mathbf{R}\) be a function which is continuous on \([a, b]\) and differentiable on \((a, b)\), and such that \(\abs*{f'(x)} \leq M\) for all \(x \in (a, b)\) (i.e., the derivative of \(f\) is bounded).
    Show that for any \(x, y \in [a, b]\) we have the inequality \(\abs*{f(x) - f(y)} \leq M \abs*{x - y}\).
    Functions which obey the bound \(\abs*{f(x) - f(y)} \leq M \abs*{x - y}\) are known as \emph{Lipschitz continuous functions} with \emph{Lipschitz constant} \(M\);
    thus this exercise shows that functions with bounded derivative are Lipschitz continuous.
\end{exercise}

\begin{exercise}\label{ex 10.2.7}
    Let \(f : \mathbf{R} \to \mathbf{R}\) be a differentiable function such that \(f'\) is bounded.
    Show that \(f\) is uniformly continuous.
\end{exercise}