\section{Piecewise constant functions}\label{sec 11.2}

\begin{definition}[Constant functions]\label{11.2.1}
    Let \(X\) be a subset of \(\mathbf{R}\), and let \(f : X \to \mathbf{R}\) be a function.
    We say that \(f\) is \emph{constant} iff there exists a real number \(c\) such that \(f(x) = c\) for all \(x \in X\).
    If \(E\) is a subset of \(X\), we say that \(f\) is \emph{constant on} \(E\) if the restriction \(f|_E\) of \(f\) to \(E\) is constant, in other words there exists a real number \(c\) such that \(f(x) = c\) for all \(x \in E\).
    We refer to \(c\) as the \emph{constant value} of \(f\) on \(E\).
\end{definition}

\begin{remark}\label{11.2.2}
    If \(E\) is a non-empty set, then a function \(f\) which is constant on \(E\) can have only one constant value;
    However, if \(E\) is empty, every real number \(c\) is a constant value for \(f\) on \(E\).
\end{remark}

\begin{definition}[Piecewise constant functions I]\label{11.2.3}
    Let \(I\) be a bounded interval, let \(f : I \to \mathbf{R}\) be a function, and let \(\mathbf{P}\) be a partition of \(I\).
    We say that \(f\) is \emph{piecewise constant with respect to \(\mathbf{P}\)} if for every \(J \in \mathbf{P}\), \(f\) is constant on \(J\).
\end{definition}

\setcounter{theorem}{4}
\begin{definition}[Piecewise constant functions II]\label{11.2.5}
    Let \(I\) be a bounded interval, and let \(f : I \to \mathbf{R}\) be a function.
    We say that \(f\) is \emph{piecewise constant on \(I\)} if there exists a partition \(\mathbf{P}\) of \(I\) such that \(f\) is piecewise constant with respect to \(\mathbf{P}\).
\end{definition}

\setcounter{theorem}{6}
\begin{lemma}\label{11.2.7}
    Let \(I\) be a bounded interval, let \(\mathbf{P}\) be a partition of \(I\), and let \(f : I \to \mathbf{R}\) be a function which is piecewise constant with respect to \(\mathbf{P}\).
    Let \(\mathbf{P}'\) be a partition of \(I\) which is finer than \(\mathbf{P}\).
    Then \(f\) is also piecewise constant with respect to \(\mathbf{P}'\).
\end{lemma}

\begin{proof}
    Let \(K' \in \mathbf{P}'\).
    Since \(\mathbf{P}'\) is finer than \(\mathbf{P}\), by Definition \ref{11.1.14} \(\exists\ K \in \mathbf{P}\) such that \(K' \subseteq K\).
    Since \(f\) is piecewise constant with respect to \(\mathbf{P}\), by Definition \ref{11.2.3} we know that \(\forall\ x \in K\), \(f(x)\) is constant.
    Thus for every \(x \in K'\), \(x \in K\) and \(f(x)\) is constant.
    By Definition \ref{11.2.3} \(f\) is piecewise constant with respect to \(\mathbf{P}'\).
\end{proof}

\begin{lemma}\label{11.2.8}
    Let \(I\) be a bounded interval, and let \(f : I \to \mathbf{R}\) and \(g : I \to \mathbf{R}\) be piecewise constant functions on \(I\).
    Then the functions \(f + g\), \(f - g\), \(\max(f, g)\), \(\min(f, g)\) and \(fg\) are also piecewise constant functions on \(I\).
    Here of course \(\max(f, g) : I \to \mathbf{R}\) is the function \(\max(f, g)(x) \coloneqq \max(f(x), g(x))\).
    If \(g\) does not vanish anywhere on \(I\) (i.e., \(g(x) \neq 0\) for all \(x \in I\)) then \(f / g\) is also a piecewise constant function on \(I\).
\end{lemma}

\begin{proof}
    Since \(f\) is piecewise constant function on \(I\), by Definition \ref{11.2.5} \(\exists\ \mathbf{P}\) such that \(\mathbf{P}\) is a partition of \(I\) and \(f\) is piecewise constant with respect to \(\mathbf{P}\).
    Similarly \(\exists\ \mathbf{P}'\) such that \(\mathbf{P}'\) is a partition of \(I\) and \(g\) is piecewise constant with respect to \(\mathbf{P}'\).
    By Lemma \ref{11.1.18} we know that \(\mathbf{P} \# \mathbf{P}'\) is also a partition of \(I\) and \(\mathbf{P} \# \mathbf{P}'\) is both finer than \(\mathbf{P}\) and finer than \(\mathbf{P}'\).
    By Lemma \ref{11.2.7} we know that both \(f\) and \(g\) are piecewise constant with respect to \(\mathbf{P} \# \mathbf{P}'\).

    Now we show that \(f, g\) remain piecewise constant functions on \(I\) after algebraic operation.
    For every \(J \in \mathbf{P} \# \mathbf{P}'\), we have \(f(x)\) is constant and \(g(x)\) is constant for every \(x \in J\).
    Thus we know that \(f(x) + g(x)\), \(f(x) - g(x)\), \(\max(f(x), g(x))\), \(\min(f(x), g(x))\) and \(f(x) g(x)\) are constant.
    If \(g(x) \neq 0\), then we also have \(f(x) / g(x)\) is constant.
    Thus by Definition \ref{11.2.3} \(f + g\), \(f - g\), \(\max(f, g)\), \(\min(f, g)\), \(fg\) is piecewise constant with respect to \(\mathbf{P} \# \mathbf{P}'\), and when \(g(x) \neq 0\) we have \(f / g\) is piecewise constant with respect to \(\mathbf{P} \# \mathbf{P}'\).
    By Definition \ref{11.2.5} \(f + g\), \(f - g\), \(\max(f, g)\), \(\min(f, g)\), \(fg\) is piecewise constant on \(I\), and when \(g(x) \neq 0\) we have \(f / g\) is piecewise constant on \(I\).
\end{proof}

\begin{definition}[Piecewise constant integral I]\label{11.2.9}
    Let \(I\) be a bounded interval, let \(\mathbf{P}\) be a partition of \(I\).
    Let \(f : I \to \mathbf{R}\) be a function which is piecewise constant with respect to \(\mathbf{P}\).
    Then we define the \emph{piecewise constant integral} \(p.c. \int_{[\mathbf{P}]} f\) of \(f\) with respect to the partition \(\mathbf{P}\) by the formula
    \[
        p.c. \int_{[\mathbf{P}]} f \coloneqq \sum_{J \in \mathbf{P}} c_J \abs*{J},
    \]
    where for each \(J\) in \(\mathbf{P}\), we let \(c_J\) be the constant value of \(f\) on \(J\).
\end{definition}

\begin{remark}\label{11.2.10}
    This definition seems like it could be ill-defined, because if \(J\) is empty then every number \(c_J\) can be the constant value of \(f\) on \(J\), but fortunately in such cases \(\abs*{J}\) is zero and so the choice of \(c_J\) is irrelevant.
    The notation \(p.c. \int_{[\mathbf{P}]} f\) is rather artificial, but we shall only need it temporarily, en route to a more useful definition.
    Note that since \(\mathbf{P}\) is finite, the sum \(\sum_{J \in \mathbf{P}} c_J \abs*{J}\) is always well-defined
    (it is never divergent or infinite).
\end{remark}

\begin{remark}\label{11.2.11}
    The piecewise constant integral corresponds intuitively to one's notion of area, given that the area of a rectangle ought to be the product of the lengths of the sides.
    (Of course, if \(f\) is negative somewhere, then the ``area'' \(c_J \abs*{J}\) would also be negative.)
\end{remark}

\setcounter{theorem}{12}
\begin{proposition}[Piecewise constant integral is independent of partition]\label{11.2.13}
    Let \(I\) be a bounded interval, and let \(f : I \to \mathbf{R}\) be a function.
    Suppose that \(\mathbf{P}\) and \(\mathbf{P}'\) are partitions of \(I\) such that \(f\) is piecewise constant both with respect to \(\mathbf{P}\) and with respect to \(\mathbf{P}'\).
    Then \(p.c. \int_{[\mathbf{P}]} f = p.c. \int_{[\mathbf{P}']} f\).
\end{proposition}

\begin{proof}
    By Lemma \ref{11.1.18} we know that \(\mathbf{P} \# \mathbf{P}'\) is a partition of \(I\) and is both finer than \(\mathbf{P}\) and finer than \(\mathbf{P}'\), thus by Definition \ref{11.2.9} we have
    \[
        p.c. \int_{[\mathbf{P} \# \mathbf{P}']} f = \sum_{J \in \mathbf{P} \# \mathbf{P}'} c_J \abs*{J}.
    \]
    By Theorem \ref{11.1.13}, we know that
    \[
        \abs*{I} = \sum_{J \in \mathbf{P}} \abs*{J} = \sum_{J \in \mathbf{P} \# \mathbf{P}'} \abs*{J}.
    \]
    By Definition \ref{11.1.14}, \(\forall\ S \in \mathbf{P} \# \mathbf{P}'\), \(\exists\ K \in \mathbf{P}\) such that \(S \subseteq K\).
    Now we fix such \(K\) and let \(\mathbf{P}_K\) be the set
    \[
        \mathbf{P}_K = \{S \in \mathbf{P} \# \mathbf{P}' : S \subseteq K\}.
    \]
    We claim that \(\mathbf{P}_K\) is a partition of \(K\).
    We know that \(\mathbf{P}_K\) is finite since \(\mathbf{P}_K \subseteq \mathbf{P} \# \mathbf{P}'\) and \(\mathbf{P} \# \mathbf{P}'\) is finite.
    Since \(\mathbf{P} \# \mathbf{P}'\) is a partition of \(I\), by Definition \ref{11.1.10} \(\forall\ S \in \mathbf{P}_K\), \(S\) is a bounded interval, and if \(S' \in \mathbf{P}_K\) and \(S \neq S'\) then \(S \cap S' = \emptyset\).
    Let \(x \in K\).
    By Definition \ref{11.1.10} we must have \(x \in I\), and \(\exists!\ K' \in \mathbf{P}'\) such that \(x \in K'\).
    By Definition \ref{11.1.16} we know that \(K \cap K' \in \mathbf{P} \# \mathbf{P}'\).
    Since \(K \cap K' \subseteq K\), we have \(x \in \bigcup \mathbf{P}_K\), so \(K \subseteq \bigcup \mathbf{P}_K\).
    By the definition of \(\mathbf{P}_K\) we know that \(\bigcup \mathbf{P}_K \subseteq K\), thus by Proposition \ref{3.1.18} we have \(K = \bigcup \mathbf{P}_K\) and by Definition \ref{11.1.10} \(\mathbf{P}_K\) is a partition of \(K\).

    Now we show that \(\bigcup_{K \in \mathbf{P}} \mathbf{P}_K = \mathbf{P} \# \mathbf{P}'\).
    By the definition of \(\mathbf{P}_K\) we have \(\bigcup_{K \in \mathbf{P}} \mathbf{P}_K \subseteq \mathbf{P} \# \mathbf{P}'\).
    Let \(S \in \mathbf{P} \# \mathbf{P}'\).
    Since \(\mathbf{P} \# \mathbf{P}'\) is finer than \(\mathbf{P}\), by Definition \ref{11.1.14} \(\exists\ K \in \mathbf{P}\) such that \(S \subseteq K\).
    Thus \(S \in \mathbf{P}_K\) and \(\mathbf{P} \# \mathbf{P}' \subseteq \bigcup_{K \in \mathbf{P}} \mathbf{P}_K\).
    Again by Proposition \ref{3.1.18} we have \(\bigcup_{K \in \mathbf{P}} \mathbf{P}_K = \mathbf{P} \# \mathbf{P}'\).

    Since \(f\) is piecewise constant with respect to \(\mathbf{P}\), by Lemma \ref{11.2.7} we know that \(f\) is piecewise constant with respect to \(\mathbf{P} \# \mathbf{P}'\).
    So we have
    \begin{align*}
        p.c. \int_{[\mathbf{P} \# \mathbf{P}']} f & = \sum_{J \in \mathbf{P} \# \mathbf{P}'} c_J \abs*{J}                        & \text{(by Definition \ref{11.2.9})}     \\
                                                  & = \sum_{J \in \bigcup_{K \in \mathbf{P}} \mathbf{P}_K} c_J \abs*{J}                                                    \\
                                                  & = \sum_{K \in \mathbf{P}} \sum_{J \in \mathbf{P}_K} c_J \abs*{J}             & \text{(by Proposition \ref{7.1.11}(e))} \\
                                                  & = \sum_{K \in \mathbf{P}} \sum_{J \in \mathbf{P}_K} c_K \abs*{J}             & (J \subseteq K)                         \\
                                                  & = \sum_{K \in \mathbf{P}} c_K \bigg(\sum_{J \in \mathbf{P}_K} \abs*{J}\bigg)                                           \\
                                                  & = \sum_{K \in \mathbf{P}} c_K \abs*{K}                                       & \text{(by Theorem \ref{11.1.13})}       \\
                                                  & = p.c. \int_{[\mathbf{P}]} f.                                                & \text{(by Definition \ref{11.2.9})}
    \end{align*}
    Using similar arguments we can show that \(p.c. \int_{[\mathbf{P}']} f = p.c. \int_{[\mathbf{P} \# \mathbf{P}']} f\).
    Thus we have \(p.c. \int_{[\mathbf{P}]} f = p.c. \int_{[\mathbf{P}']} f\).
\end{proof}

\begin{definition}[Piecewise constant integral II]\label{11.2.14}
    Let \(I\) be a bounded interval, and let \(f : I \to \mathbf{R}\) be a piecewise constant function on \(I\).
    We define the \emph{piecewise constant integral} \(p.c. \int_I f\) by the formula
    \[
        p.c. \int_I f \coloneqq p.c. \int_{[\mathbf{P}]} f,
    \]
    where \(\mathbf{P}\) is any partition of \(I\) with respect to which \(f\) is piecewise constant.
    (Note that Proposition \ref{11.2.13} tells us that the precise choice of this partition is irrelevant.)
\end{definition}

\setcounter{theorem}{15}
\begin{theorem}[Laws of integration]\label{11.2.16}
    Let \(I\) be a bounded interval, and let \(f : I \to \mathbf{R}\) and \(g : I \to \mathbf{R}\) be piecewise constant functions on \(I\).
    \begin{enumerate}
        \item We have \(p.c. \int_I (f + g) = p.c. \int_I f + p.c. \int_I g\).
        \item For any real number \(c\), we have \(p.c. \int_I (cf) = c (p.c. \int_I f)\).
        \item We have \(p.c. \int_I (f - g) = p.c. \int_I f - p.c. \int_I g\).
        \item If \(f(x) \geq 0\) for all \(x \in I\), then \(p.c. \int_I f \geq 0\).
        \item If \(f(x) \geq g(x)\) for all \(x \in I\), then \(p.c. \int_I f \geq p.c. \int_I g\).
        \item If \(f\) is the constant function \(f(x) = c\) for all \(x \in I\), then \(p.c. \int_I f = c \abs*{I}\).
        \item Let \(J\) be a bounded interval containing \(I\) (i.e., \(I \subseteq J\)), and let \(F : J \to \mathbf{R}\) be the function
              \[
                  F(x) \coloneqq \begin{cases}
                      f(x) & \text{if } x \in I    \\
                      0    & \text{if } x \notin I
                  \end{cases}
              \]
              Then \(F\) is piecewise constant on \(J\), and \(p.c. \int_J F = p.c. \int_I f\).
        \item Suppose that \(\{J, K\}\) is a partition of \(I\) into two intervals \(J\) and \(K\).
              Then the function \(f|_J : J \to \mathbf{R}\) and \(f|_K : K \to \mathbf{R}\) are piecewise constant on \(J\) and \(K\) respectively, and we have
              \[
                  p.c. \int_I f = p.c. \int_J f|_J + p.c. \int_K f|_K.
              \]
    \end{enumerate}
\end{theorem}

\begin{proof}{(a)}
    Since \(f, g\) are both piecewise constant on \(I\), by Lemma \ref{11.2.8} \(f + g\) is also piecewise constant on \(I\).
    By Definition \ref{11.2.3}, \(\exists\ \mathbf{P}_f, \mathbf{P}_g\) such that \(\mathbf{P}_f, \mathbf{P}_g\) are partitions of \(I\), \(f\) is piecewise constant with respect to \(\mathbf{P}_f\) and \(g\) is piecewise constant with respect to \(\mathbf{P}_g\).
    Let \(\mathbf{P} = \mathbf{P}_f \# \mathbf{P}_g\).
    Then by Lemma \ref{11.1.18} we know that \(\mathbf{P}\) is also a partition of \(I\) and by Lemma \ref{11.2.7} \(f, g\) are piecewise constant with respect to \(\mathbf{P}\).
    Now let \(J \in \mathbf{P}\), let \(f_J \in \mathbf{R}\) be the constant value of \(f\) on \(J\) and \(g_J \in \mathbf{R}\) be the constant value of \(g\) on \(J\).
    Then by Definition \ref{11.2.1} \(f_J + g_J\) is also a constant of \(f + g\) on \(J\).
    Thus we have \(f + g\) is piecewise constant with respect to \(\mathbf{P}\) and
    \begin{align*}
        p.c. \int_I f + p.c. \int_I g & = p.c. \int_{[\mathbf{P}]} f + p.c. \int_{[\mathbf{P}]} g                     & \text{(by Definition \ref{11.2.14})}    \\
                                      & = \sum_{J \in \mathbf{P}} f_J \abs*{J} + \sum_{J \in \mathbf{P}} g_J \abs*{J} & \text{(by Definition \ref{11.2.9})}     \\
                                      & = \sum_{J \in \mathbf{P}} (f_J + g_J) \abs*{J}                                & \text{(by Proposition \ref{7.1.11}(f))} \\
                                      & = p.c. \int_{[\mathbf{P}]} (f_J + g_J)                                        & \text{(by Definition \ref{11.2.9})}     \\
                                      & = p.c. \int_I (f_J + g_J).                                                    & \text{(by Definition \ref{11.2.14})}
    \end{align*}
\end{proof}

\begin{proof}{(b)}
    Since \(f\) is piecewise constant on \(I\), by Lemma \ref{11.2.8} \(cf\) is also piecewise constant on \(I\) (since \(c\) is constant on \(I\)).
    By Definition \ref{11.2.3}, \(\exists\ \mathbf{P}\) such that \(\mathbf{P}\) is a partition of \(I\) and \(f\) is piecewise constant with respect to \(\mathbf{P}\).
    Now let \(J \in \mathbf{P}\) and let \(f_J \in \mathbf{R}\) be the constant value of \(f\) on \(J\).
    Then by Definition \ref{11.2.1} \(c f_J\) is also a constant of \(cf\) on \(J\).
    Thus we have \(cf\) is piecewise constant with respect to \(\mathbf{P}\) and
    \begin{align*}
        c (p.c. \int_I f) & = c (p.c. \int_{[\mathbf{P}]} f)           & \text{(by Definition \ref{11.2.14})}    \\
                          & = c (\sum_{J \in \mathbf{P}} f_J \abs*{J}) & \text{(by Definition \ref{11.2.9})}     \\
                          & = \sum_{J \in \mathbf{P}} c f_J \abs*{J}   & \text{(by Proposition \ref{7.1.11}(g))} \\
                          & = p.c. \int_{[\mathbf{P}]} (c f)           & \text{(by Definition \ref{11.2.9})}     \\
                          & = p.c. \int_I (c f).                       & \text{(by Definition \ref{11.2.14})}
    \end{align*}
\end{proof}

\begin{proof}{(c)}
    We have
    \begin{align*}
        p.c. \int_I f - p.c. \int_I g & = p.c. \int_I f + (-1) p.c. \int_I g                                        \\
                                      & = p.c. \int_I f + p.c. \int_I (-g)   & \text{(by Theorem \ref{11.2.16}(b))} \\
                                      & = p.c. \int_I (f + (-g))             & \text{(by Theorem \ref{11.2.16}(a))} \\
                                      & = p.c. \int_I (f - g).               & \text{(by Definition \ref{9.2.1})}
    \end{align*}
\end{proof}

\begin{proof}{(d)}
    By Definition \ref{11.2.3}, \(\exists\ \mathbf{P}\) such that \(\mathbf{P}\) is a partition of \(I\) and \(f\) is piecewise constant with respect to \(\mathbf{P}\).
    Let \(J \in \mathbf{P}\) and let \(f_J \in \mathbf{R}\) be the constant value of \(f\) on \(J\).
    Since \(\forall\ x \in I\), \(f(x) \geq 0\), we then have \(f_J \geq 0\) and \(f_J \abs*{J} \geq 0\).
    Thus
    \begin{align*}
        p.c. \int_I f & = p.c. \int_{[\mathbf{P}]} f           & \text{(by Definition \ref{11.2.14})}    \\
                      & = \sum_{J \in \mathbf{P}} f_J \abs*{J} & \text{(by Definition \ref{11.2.9})}     \\
                      & \geq \sum_{J \in \mathbf{P}} 0         & \text{(by Proposition \ref{7.1.11}(h))} \\
                      & = 0.
    \end{align*}
\end{proof}

\begin{proof}{(e)}
    Since \(f(x) \geq g(x)\) for all \(x \in I\), we have \(f(x) - g(x) \geq 0\) and
    \begin{align*}
        p.c. \int_I f - p.c. \int_I g & = p.c. \int_I (f - g) & \text{(by Theorem \ref{11.2.16}(c))} \\
                                      & \geq 0.               & \text{(by Theorem \ref{11.2.16}(d))}
    \end{align*}
    Thus
    \[
        p.c. \int_I f \geq p.c. \int_I g.
    \]
\end{proof}

\begin{proof}{(f)}
    Since \(I\) is a partition of \(I\), we have
    \begin{align*}
        p.c. \int_I f & = p.c. \int_{[I]} f         & \text{(by Definition \ref{11.2.14})}    \\
                      & = \sum_{J \in I} c \abs*{J} & \text{(by Definition \ref{11.2.9})}     \\
                      & = c \sum_{J \in I} \abs*{J} & \text{(by Proposition \ref{7.1.11}(g))} \\
                      & = c \abs*{I}.               & \text{(by Theorem \ref{11.1.13})}
    \end{align*}
\end{proof}

\begin{proof}{(g)}
    Let \(I_1, I_2\) be the sets
    \[
        I_1 = \{x \in J, x \leq \inf(I) \land x \notin I\}
    \]
    and
    \[
        I_2 = \{x \in J, x \geq \sup(I) \land x \notin I \cup I_1\}.
    \]
    Then we know that \(I \cap I_1 = I \cap I_2 = I_1 \cap I_2 = \emptyset\).
    Let \(\mathbf{P} = \{I_1, I, I_2\}\).
    We now claim that \(\mathbf{P}\) is a partition of \(J\).
    Since \(J\) is a bounded interval, we know that \(\inf(J) = \inf(I_1)\) and \(\sup(J) = \sup(I_2)\).
    Then we have \(I_1 \subseteq [\inf(J), \inf(I)]\) and \(I_2 \subseteq [\sup(I), \sup(J)]\).
    If \(\inf(J) \in J\), then we know that \(I_1 = [\inf(J), \inf(I)]\) or \(I_1 = [\inf(J), \inf(I))\), which depends on whether \(\inf(I) \in I\).
    Otherwise we have \(I_1 = (\inf(J), \inf(I)]\) or \(I_1 = (\inf(J), \inf(I))\), which again depends on whether \(\inf(I) \in I\).
    Using similar arguments we know thtat \(I_2\) can be one of \((\sup(I), \sup(J))\), \([\sup(I), \sup(J))\), \((\sup(I), \sup(J)]\) or \([\sup(I), \sup(J)]\).
    Thus \(I_1, I_2\) are bounded intervals.
    By the definition of \(I_1, I_2\), we know that \(\bigcup \mathbf{P} \subseteq J\).
    To show that \(\bigcup \mathbf{P} = J\), by Proposition \ref{3.1.18} we need to show that \(J \subseteq \bigcup \mathbf{P}\).
    Let \(x \in J\).
    If \(x \in I\), we have \(x \in \bigcup \mathbf{P}\).
    If \(x \notin I\), we then have \(x \leq \inf(I) \lor x \geq \sup(I)\), thus \(x \in I_1 \lor x \in I_2\), and again \(x \in \bigcup \mathbf{P}\).
    Since \(x\) is arbitrary, we have \(J \subseteq \mathbf{P}\).
    Since \(\bigcup \mathbf{P} = J\) and \(\mathbf{P}\) is finite (\(\abs*{P} = 3\)), by Definition \ref{11.1.10} \(\mathbf{P}\) is a partition of \(J\).

    Now we show that \(F\) is piecewise constant on \(J\).
    Since \(f\) is piecewise constant on \(I\), by Definition \ref{11.2.5} \(\exists\ \mathbf{P}_I\) such that \(\mathbf{P}_I\) be the partition of \(I\) and \(f\) is piecewise constant with respect to \(\mathbf{P}_I\).
    By hypothesis we know that \(\forall\ K \in \mathbf{P}_I\), \(F\) is piecewise constant on \(K\) with constant value \(F(x) = f(x)\) for all \(x \in K\), thus by Definition \ref{11.2.5} \(F\) is piecewise constant on \(I\).
    Since \(\forall\ x \in I_1\), \(x \notin I\), by hypothesis we know that \(F(x) = 0\), thus \(F\) is piecewise constant on \(I_1\).
    Similar arguments show that \(F\) is piecewise constant on \(I_2\).
    Thus \(F\) is piecewise constant on \(\mathbf{P}\), and we have
    \begin{align*}
        p.c. \int_J F & = p.c. \int_{[\mathbf{P}]} F                                                       & \text{(by Definition \ref{11.2.14})}    \\
                      & = \sum_{K \in \mathbf{P}} c_K \abs*{K}                                             & \text{(by Definition \ref{11.2.9})}     \\
                      & = c_{I_1} \abs*{I_1} + \sum_{K \in \mathbf{P}_I} c_K \abs*{K} + c_{I_2} \abs*{I_2} & \text{(by Proposition \ref{7.1.11}(e))} \\
                      & = 0 \abs*{I_1} + \sum_{K \in \mathbf{P}_I} c_K \abs*{K} + 0 \abs*{I_2}             & \text{(by hypothesis)}                  \\
                      & = \sum_{K \in \mathbf{P}_I} c_K \abs*{K}                                                                                     \\
                      & = p.c. \int_{[\mathbf{P}_I]} f                                                     & \text{(by Definition \ref{11.2.9})}     \\
                      & = p.c. \int_I f.                                                                   & \text{(by Definition \ref{11.2.14})}
    \end{align*}
\end{proof}

\begin{proof}{(h)}
    We first show that \(f|_J\) is piecewise constant on \(J\) and \(f|_K\) is piecewise constant on \(K\).
    Since \(f\) is a piecewise constant function on \(I\), by Definition \ref{11.2.5} \(\exists\ \mathbf{P}\) such that \(\mathbf{P}\) is a partition of \(I\) and \(f\) is piecewise constant with respect to \(\mathbf{P}\).
    Let \(\mathbf{P}_J, \mathbf{P}_K\) be the sets
    \[
        \mathbf{P}_J = \{S \cap J : S \in \mathbf{P}\}
    \]
    and
    \[
        \mathbf{P}_K = \{S \cap K : S \in \mathbf{P}\}.
    \]
    Since \(\forall\ S_J \in \mathbf{P}_J\), \(S_J \in \mathbf{P}\), by Definition \ref{11.2.3} we know that \(f\) is constant on \(S_J\),
    By Definition \ref{11.1.10} \(S_J\) is a bounded interval, and \(S_{J'} \in \mathbf{P}_J\) and \(S_{J'} \neq S_J \implies S_{J'} \cap S_J = \emptyset\).
    By the definition of \(\mathbf{P}_J\) we know that \(\bigcup \mathbf{P}_J \subseteq J\).
    Let \(x \in J\).
    Since \(x \in J\), \(x \in I\), by Definition \ref{11.1.10} \(\exists!\ S_J \in \mathbf{P}_J\) such that \(x \in S_J\).
    Then we have \(x \in J \cap S_J\) and \(x \in \bigcup \mathbf{P}_J\), thus \(J \subseteq \bigcup \mathbf{P}_J\) and by Proposition \ref{3.1.18} \(J = \bigcup \mathbf{P}_J\).
    Since \(\mathbf{P}_J \subseteq \mathbf{P}\) and \(\mathbf{P}\) is finite, we know that \(\mathbf{P}_J\) is finite.
    Thus by Definition \ref{11.1.10} \(\mathbf{P}_J\) is a partition of \(J\).
    Using similar arguments we can show that \(\mathbf{P}_K\) is a partition of \(K\).
    Since \(\forall\ S_J \in \mathbf{P}_J\), \(S_J \in \mathbf{P}\) and \(f\) is piecewise constant on \(S_J\), by Definition \ref{11.2.3} \(f|_J\) is piecewise constant with respect to \(\mathbf{P}_J\).
    Using similar arguments we know that \(f|_K\) is piecewise constant with respect to \(\mathbf{P}_K\).
    Thus by Definition \ref{11.2.5} \(f|_J\) is piecewise constant on \(J\) and \(f|_K\) is piecewise constant on \(K\).

    Now we show that \(\mathbf{P} = \mathbf{P}_J \cup \mathbf{P}_K\).
    By the definition of \(\mathbf{P}_J\) and \(\mathbf{P}_K\) we know that \(\mathbf{P}_J \cup \mathbf{P}_J \subseteq \mathbf{P}\).
    Let \(S \in \mathbf{P}\).
    If \(S = \emptyset\), then \(S \subseteq \mathbf{P}_J \cup \mathbf{P}_K\).
    If \(S \neq \emptyset\), since \(S \subseteq I\) and \(\{J, K\}\) is a partition of \(I\), we know that \(S \cap (J \cup K) \neq \emptyset\).
    Thus we have \(S \in \mathbf{P}_J\) or \(S \in \mathbf{P}_K\), which means \(\mathbf{P} \subseteq \mathbf{P}_J \cup \mathbf{P}_K\).
    By Proposition \ref{3.1.18} we have \(\mathbf{P} = \mathbf{P}_J \cup \mathbf{P}_K\).
    Thus we have
    \begin{align*}
        p.c. \int_J f|_J + p.c. \int_K f|_K & = p.c. \int_{[\mathbf{P}_J]} f|_J + p.c. \int_{[\mathbf{P}_K]} f|_K               & \text{(by Definition \ref{11.2.14})}    \\
                                            & = \sum_{S \in \mathbf{P}_J} c_S \abs*{S} + \sum_{S \in \mathbf{P}_K} c_S \abs*{S} & \text{(by Proposition \ref{7.1.11}(e))} \\
                                            & = \sum_{S \in \mathbf{P}_J \cup \mathbf{P}_K} c_S \abs*{S}                        & \text{(by Definition \ref{11.2.9})}     \\
                                            & = \sum_{S \in \mathbf{P}} c_S \abs*{S}                                                                                      \\
                                            & = p.c. \int_{[\mathbf{P}]} f                                                      & \text{(by Definition \ref{11.2.9})}     \\
                                            & = p.c. \int_I f.                                                                  & \text{(by Definition \ref{11.2.14})}
    \end{align*}
\end{proof}

\exercisesection

\begin{exercise}\label{ex 11.2.1}
    Prove Lemma \ref{11.2.7}.
\end{exercise}

\begin{proof}
    See Lemma \ref{11.2.7}.
\end{proof}

\begin{exercise}\label{ex 11.2.2}
    Prove Lemma \ref{11.2.8}.
\end{exercise}

\begin{proof}
    See Lemma \ref{11.2.8}.
\end{proof}

\begin{exercise}\label{ex 11.2.3}
    Prove Proposition \ref{11.2.13}.
\end{exercise}

\begin{proof}
    See Proposition \ref{11.2.13}.
\end{proof}

\begin{exercise}\label{ex 11.2.4}
    Prove Theorem \ref{11.2.16}.
\end{exercise}

\begin{proof}
    See Theorem \ref{11.2.16}.
\end{proof}