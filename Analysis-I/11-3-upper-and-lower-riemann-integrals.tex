\section{Upper and lower Riemann integrals}\label{sec 11.3}

\begin{definition}[Majorization of functions]\label{11.3.1}
    Let \(f : I \to \mathbf{R}\) and \(g : I \to \mathbf{R}\).
    We say that \(g\) \emph{majorizes} \(f\) on \(I\) if we have \(g(x) \geq f(x)\) for all \(x \in I\), and that \(g\) \emph{minorizes} \(f\) on \(I\) if \(g(x) \leq f(x)\) for all \(x \in I\).
\end{definition}

\begin{definition}[Upper and lower Riemann integrals]\label{11.3.2}
    Let \(f : I \to \mathbf{R}\) be a bounded function defined on a bounded interval \(I\).
    We define the \emph{upper Riemann integral} \(\overline{\int}_I f\) by the formula
    \[
        \overline{\int}_I f \coloneqq \inf\{p.c. \int_I g : g \text{ is a piecewise constant function on \(I\) which majorizes } f\}
    \]
    and the \emph{lower Riemann integral} \(\underline{\int}_I f\) by the formula
    \[
        \underline{\int}_I f \coloneqq \sup\{p.c. \int_I g : g \text{ is a piecewise constant function on \(I\) which minorizes } f\}.
    \]
\end{definition}

\begin{lemma}\label{11.3.3}
    Let \(f : I \to \mathbf{R}\) be a function on a bounded interval \(I\) which is bounded by some real number \(M\), i.e., \(-M \leq f(x) \leq M\) for all \(x \in I\).
    Then we have
    \[
        -M \abs*{I} \leq \underline{\int}_I f \leq \overline{\int}_I f \leq M \abs*{I}.
    \]
    in particular, both the lower and upper Riemann integrals are real numbers (i.e., they are not infinite).
\end{lemma}

\begin{proof}
    The function \(g : I \to \mathbf{R}\) defined by \(g(x) = M\) is constant, hence piecewise constant, and majorizes \(f\);
    thus \(\overline{\int}_I f \leq p.c. \int_I g = M \abs*{I}\) by definition of the upper Riemann integral.
    A similar argument gives \(-M \abs*{I} \leq \underline{\int}_I f\).
    Finally, we have to show that \(\underline{\int}_I f \leq \overline{\int}_I f\).
    Let \(g\) be any piecewise constant function majorizing \(f\), and let \(h\) be any piecewise constant function minorizing \(f\).
    Then \(g\) majorizes \(h\), and hence \(p.c. \int_I h \leq p.c. \int_I g\).
    Taking suprema in \(h\), we obtain that \(\underline{\int}_I f \leq p.c. \int_I g\).
    Taking infima in \(g\), we thus obtain \(\underline{\int}_I f \leq \overline{\int}_I f\), as desired.
\end{proof}

\begin{definition}[Riemann integral]\label{11.3.4}
    Let \(f : I \to \mathbf{R}\) be a bounded function on a bounded interval \(I\).
    If \(\underline{\int}_I f = \overline{\int}_I f\), then we say that \(f\) is \emph{Riemann integrable on \(I\)} and define
    \[
        \int_I f \coloneqq \underline{\int}_I f = \overline{\int}_I f.
    \]
    If the upper and lower Riemann integrals are unequal, we say that \(f\) is not Riemann integrable.
\end{definition}

\begin{remark}\label{11.3.5}
    Compare this definition to the relationship between the \(\limsup\), \(liminf\), and limit of a sequence \(a_n\) that was established in Proposition \ref{6.4.12}(f);
    the \(\limsup\) is always greater than or equal to the \(\liminf\), but they are only equal when the sequence converges, and in this case they are both equal to the limit of the sequence.
    The definition given above may differ from the definition you may have encountered in your calculus courses, based on Riemann sums.
    However, the two definitions turn out to be equivalent.
\end{remark}

\begin{remark}\label{11.3.6}
    Note that we do not consider unbounded functions to be Riemann integrable;
    an integral involving such functions is known as an \emph{improper integral}.
    It is possible to still evaluate such integrals using more sophisticated integration methods (such as the Lebesgue integral).
\end{remark}

\begin{lemma}\label{11.3.7}
    Let \(f : I \to \mathbf{R}\) be a piecewise constant function on a bounded interval \(I\).
    Then \(f\) is Riemann integrable, and \(\int_I f = p.c. \int_I f\).
\end{lemma}

\begin{proof}
    Since \(f(x) \leq f(x)\), by Definition \ref{11.3.2} we have
    \[
        \overline{\int}_I f \leq p.c. \int_I f
    \]
    and
    \[
        p.c. \int_I f \leq \underline{\int}_I f.
    \]
    By Lemma \ref{11.3.3} we know that
    \[
        p.c. \int_I f \leq \underline{\int}_I f \leq \overline{\int}_I f \leq p.c. \int_I f.
    \]
    Thus by Definition \ref{11.3.4} we have
    \[
        \int_I f = \underline{\int}_I f = \overline{\int}_I f = p.c. \int_I f.
    \]
\end{proof}