\section{Riemann integrability of monotone functions}\label{sec 11.6}

\begin{proposition}\label{11.6.1}
    Let \([a, b]\) be a closed and bounded interval and let \(f : [a, b] \to \mathbf{R}\) be a monotone function.
    Then \(f\) is Riemann integrable on \([a, b]\).
\end{proposition}

\begin{proof}
    Without loss of generality we may take \(f\) to be monotone increasing (instead of monotone decreasing).
    From Exercise \ref{ex 9.8.1} we know that \(f\) is bounded.
    Now let \(N > 0\) be an integer, and partition \([a, b]\) into \(N\) half-open intervals \(\{[a + \frac{b - a}{N} j, a + \frac{b - a}{N} (j + 1)) : 0 \leq j \leq N - 1\}\) of length \((b - a) / N\), together with the point \(\{b\}\).
    Then by Proposition \ref{11.3.12} we have
    \[
        \overline{\int}_I f \leq \sum_{j = 0}^{N - 1} \Bigg(\sup_{x \in [a + \frac{b - a}{N} j, a + \frac{b - a}{N} (j + 1))} f(x)\Bigg) \frac{b - a}{N},
    \]
    (the point \(\{b\}\) clearly giving only a zero contribution).
    Since \(f\) is monotone increasing, we thus have
    \[
        \overline{\int}_I f \leq \sum_{j = 0}^{N - 1} f\bigg(a + \frac{b - a}{N} (j + 1)\bigg) \frac{b - a}{N}.
    \]
    Similarly we have
    \[
        \underline{\int}_I f \geq \sum_{j = 0}^{N - 1} f\bigg(a + \frac{b - a}{N} j\bigg) \frac{b - a}{N}.
    \]
    Thus we have
    \[
        \overline{\int}_I f - \underline{\int}_I f \leq \sum_{j = 0}^{N - 1} \Bigg(f\bigg(a + \frac{b - a}{N} (j + 1)\bigg) - f\bigg(a + \frac{b - a}{N} j\bigg)\Bigg) \frac{b - a}{N}.
    \]
    Using telescoping series (Lemma \ref{7.2.15}) we thus have
    \begin{align*}
        \overline{\int}_I f - \underline{\int}_I f & \leq \Bigg(f\bigg(a + \frac{b - a}{N} N\bigg) - f\bigg(a + \frac{b - a}{N} 0\bigg)\Bigg) \frac{b - a}{N} \\
                                                   & = (f(b) - f(a)) \frac{b - a}{N}.
    \end{align*}
    But \(N\) was arbitrary, so we can conclude as in the proof of Theorem \ref{11.5.1} that \(f\) is Riemann integrable.
\end{proof}

\begin{remark}\label{11.6.2}
    From Exercise \ref{ex 9.8.5} we know that there exist monotone functions which are not piecewise continuous, so Proposition \ref{11.6.1} is not subsumed by Proposition \ref{11.5.6}.
\end{remark}

\begin{corollary}\label{11.6.3}
    Let \(I\) be a bounded interval, and let \(f : I \to \mathbf{R}\) be both monotone and bounded.
    Then \(f\) is Riemann integrable on \(I\).
\end{corollary}

\begin{proof}
    If \(I\) is a point or an empty set then the claim is trivial;
    if \(I\) is a closed interval the claim follows from Proposition \ref{11.6.1}.
    So let us assume that \(I\) is of the form \((a, b]\), \((a, b)\), or \([a, b)\) for some \(a < b\).

    We have a bound \(M\) for \(f\), so that \(-M \leq f(x) \leq M\) for all \(x \in I\).
    Now let \(0 < \varepsilon < (b - a) / 2\) be a small number.
    The function \(f\) when restricted to the interval \([a + \varepsilon, b - \varepsilon]\) is monotone, and hence Riemann integrable by Proposition \ref{11.6.1}.
    In particular, we can find a piecewise constant function \(h : [a + \varepsilon, b - \varepsilon] \to \mathbf{R}\) which majorizes \(f\) on \([a + \varepsilon, b - \varepsilon]\) such that
    \[
        \int_{[a + \varepsilon, b - \varepsilon]} h \leq \int_{[a + \varepsilon, b - \varepsilon]} f + \varepsilon.
    \]
    Define \(\tilde{h} : I \to \mathbf{R}\) by
    \[
        \tilde{h}(x) \coloneqq \begin{cases}
            h(x) & \text{if } x \in [a + \varepsilon, b - \varepsilon]             \\
            M    & \text{if } x \in I \setminus [a + \varepsilon, b - \varepsilon]
        \end{cases}
    \]
    Clearly \(\tilde{h}\) is piecewise constant on \(I\) and majorizes \(f\);
    by Theorem \ref{11.2.16} we have
    \[
        \int_I \tilde{h} = \varepsilon M + \int_{[a + \varepsilon, b - \varepsilon]} h + \varepsilon M \leq \int_{[a + \varepsilon, b - \varepsilon]} f + (2M + 1) \varepsilon.
    \]
    In particular we have
    \[
        \overline{\int}_I f \leq \int_{[a + \varepsilon, b - \varepsilon]} f + (2M + 1) \varepsilon
    \]
    (since \(\overline{\int}_{I \cap [a, a + \varepsilon]} f \leq M \varepsilon\) and \(\overline{\int}_{I \cap [b, b - \varepsilon]} f \leq M \varepsilon\)).
    A similar argument gives
    \[
        \underline{\int}_I f \geq \int_{[a + \varepsilon, b - \varepsilon]} f - (2M + 1) \varepsilon.
    \]
    and hence
    \[
        \overline{\int}_I f - \underline{\int}_I f \leq (4M + 2) \varepsilon.
    \]
    But \(\varepsilon\) is arbitrary, and so we can argue as in the proof of Theorem \ref{11.5.1} to conclude Riemann integrability.
\end{proof}

\begin{proposition}[Integral test]\label{11.6.4}
    Let \(f : [0, \infty) \to \mathbf{R}\) be a monotone decreasing function which is non-negative
    (i.e., \(f(x) \geq 0\) for all \(x \geq 0\)).
    Then the sum \(\sum_{n = 0}^\infty f(n)\) is convergent if and only if \(\sup_{N > 0} \int_{[0, N]} f\) is finite.
\end{proposition}

\begin{proof}
    Let \(N \in \mathbf{N}\) and \(N > 0\).
    Since \(f\) is monotone decreasing, by Proposition \ref{11.6.1} we know that \(f\) is Riemann integrable on both \([0, N]\) and every interval \([a, b] \subseteq [0, N]\).
    Then we have
    \begin{align*}
        \int_{[0, N]} f & = \sum_{n = 0}^{N - 1} \int_{[n, n + 1)} f|_{[n, n + 1)} + \int_{[N, N]} f|_{[N, N]} & \text{(by Exercise \ref{ex 11.4.3})}      \\
                        & = \sum_{n = 0}^{N - 1} \int_{[n, n + 1)} f|_{[n, n + 1)}                             & \text{(by Definition \ref{11.1.8})}       \\
                        & \leq \sum_{n = 0}^{N - 1} \int_{[n, n + 1)} f(n)                                     & \text{(by Theorem \ref{11.4.1}(e))}       \\
                        & = \sum_{n = 0}^{N - 1} f(n) \abs*{n + 1 - n}                                         & \text{(by Definition \ref{11.2.9})}       \\
                        & = \sum_{n = 0}^{N - 1} f(n)                                                                                                      \\
                        & \leq \sum_{n = 0}^N f(n)                                                             & (\forall\ x \in [0, \infty), f(x) \geq 0)
    \end{align*}
    and
    \begin{align*}
        \int_{[0, N]} f & = \sum_{n = 0}^{N - 1} \int_{[n, n + 1)} f|_{[n, n + 1)} + \int_{[N, N]} f|_{[N, N]} & \text{(by Exercise \ref{ex 11.4.3})} \\
                        & = \sum_{n = 0}^{N - 1} \int_{[n, n + 1)} f|_{[n, n + 1)}                             & \text{(by Definition \ref{11.1.8})}  \\
                        & \geq \sum_{n = 0}^{N - 1} \int_{[n, n + 1)} f(n + 1)                                 & \text{(by Theorem \ref{11.4.1}(e))}  \\
                        & = \sum_{n = 0}^{N - 1} f(n + 1) \abs*{n + 1 - n}                                     & \text{(by Definition \ref{11.2.9})}  \\
                        & = \sum_{n = 0}^{N - 1} f(n + 1)                                                                                             \\
                        & = \sum_{n = 1}^N f(n).                                                               & \text{(by Lemma \ref{7.1.4}(b))}
    \end{align*}

    Suppose that \(\sum_{n = 0}^\infty f(n)\) is convergent.
    Then by Definition \ref{7.2.2} we know that
    \[
        \sum_{n = 0}^\infty f(n) = \lim_{m \to \infty} \sum_{n = 0}^m f(n)
    \]
    and by Proposition \ref{6.1.12} \((\sum_{n = 0}^m f(n))_{m = 0}^\infty\) is a Cauchy sequence.
    By Lemma \ref{5.1.15} we know that \((\sum_{n = 0}^m f(n))_{m = 0}^\infty\) is bounded by some \(M \in \mathbf{R}\).
    By Comparison principle (Lemma \ref{6.4.13}) we have
    \[
        \sup \bigg(\int_{[0, N] f}\bigg)_{N = 1}^\infty \leq \sup \bigg(\sum_{n = 0}^N f(n)\bigg)_{N = 1}^\infty \leq M
    \]
    and thus \(\sup_{N > 0} \int_{[0, N]} f\) is finite.

    Now suppose that \(\sup_{N > 0} \int_{[0, N]} f\) is finite.
    By Comparison principle (Lemma \ref{6.4.13}) we have
    \[
        \sup \bigg(\sum_{n = 1}^N f(n)\bigg)_{N = 1}^\infty \leq \sup \bigg(\int_{[0, N] f}\bigg)_{N = 1}^\infty
    \]
    By Proposition \ref{7.3.1} we thus have \(\sum_{n = 0}^\infty f(n)\) is convergent.
\end{proof}

\begin{corollary}\label{11.6.5}
    Let \(p\) be a real number.
    Then \(\sum_{n = 1}^\infty \frac{1}{n^p}\) converges absolutely when \(p > 1\) and diverges when \(p \leq 1\).
\end{corollary}

\begin{proof}
    First suppose that \(p > 1\).
    Let \(f : [1, \infty) \to \mathbf{R}\) be the function \(f(x) = \frac{1}{x^p}\).
    By Proposition \ref{6.7.3}(a)(e) we know that \(f\) is positive and monotone decreasing.
    Let \(N \in \mathbf{N}\) and \(N > 1\).
    Then by Proposition \ref{11.6.1} we know that \(\int_{[1, N]} f\) is Riemann integrable.
    Let \(x \in [1, \infty)\).
    Since \(p > 1\), we have \(p - 1 > 0\) and by Archimedean property (Corollary \ref{5.4.13}) we know that \(\exists\ M \in \mathbf{N}\) and \(M > 0\) such that \(M(N - 1)(p - 1) > 1 = 1^p > x^p\).
    This means \(\frac{1}{x^p} < \frac{1}{M(N - 1)(p - 1)}\) and thus
    \begin{align*}
        \int_{[1, N]} f & \leq \int_{[1, N]} \frac{1}{M(N - 1)(p - 1)}   & \text{(by Theorem \ref{11.4.1}(e))} \\
                        & = p.c. \int_{[1, N]} \frac{1}{M(N - 1)(p - 1)} & \text{(by Lemma \ref{11.3.7})}      \\
                        & = \frac{N - 1}{M(N - 1)(p - 1)}                & \text{(by Definition \ref{11.2.9})} \\
                        & = \frac{1}{M(p - 1)}                                                                 \\
                        & \leq \frac{1}{p - 1}.
    \end{align*}
    Since \(\int_{[1, N]} f \leq \frac{1}{p - 1}\) for all \(N > 1\), we have \(\sup_{N > 1} \int_{[1, N]} f \leq \frac{1}{p - 1}\), and thus by Proposition \ref{11.6.4} we know that \(\sum_{n = 1}^\infty f(n)\) is convergent.
\end{proof}

\exercisesection

\begin{exercise}\label{ex 11.6.1}
    Use Proposition \ref{11.6.1} to prove Corollary \ref{11.6.3}.
\end{exercise}

\begin{proof}
    See Corollary \ref{11.6.3}.
\end{proof}

\begin{exercise}\label{ex 11.6.2}
    Formulate a reasonable notion of a piecewise monotone function, and then show that all bounded piecewise monotone functions are Riemann integrable.
\end{exercise}

\begin{proof}
    Let \(I\) be a bounded interval, and let \(f : I \to \mathbf{R}\).
    We say that \(f\) is \emph{piecewise monotone on \(I\)} iff there exists a partition \(\mathbf{P}\) of \(I\) such that \(f|_J\) is monotone on \(J\) for all \(J \in \mathbf{P}\).

    Now we show that all bounded piecewise monotone functions are Riemann integrable.
    Suppose that \(f : I \to \mathbf{R}\) is a bounded piecewise monotone function.
    Then by the definition \(\exists\ \mathbf{P}\) such that \(\mathbf{P}\) is a partition of \(I\) and \(f|_J\) is monotone on \(J\) for all \(J \in \mathbf{P}\).
    Since \(f\) is bounded, \(f|_J\) is also bounded, by Corollary \ref{11.6.3} we know that \(f|_J\) is Riemann integrable on \(J\).
    Let \(F_J : I \to \mathbf{R}\) be the function
    \[
        F_J(x) = \begin{cases}
            f|_J(x) & \text{if } x \in J    \\
            0       & \text{if } x \notin J
        \end{cases}
    \]
    Then by Theorem \ref{11.4.1}(g) we know that \(F_J\) is Riemann integrable and
    \begin{align*}
        \sum_{J \in \mathbf{P}} \int_I F_J & = \sum_{J \in \mathbf{P}} \int_J f|_J & \text{(by Theorem \ref{11.4.1}(g))}  \\
                                           & = \int_I f.                           & \text{(by Exercise \ref{ex 11.4.3})}
    \end{align*}
    Thus \(f\) is Riemann integrable on \(I\).
\end{proof}

\begin{exercise}\label{ex 11.6.3}
    Prove Proposition \ref{11.6.4}.
\end{exercise}

\begin{proof}
    See Proposition \ref{11.6.4}.
\end{proof}

\begin{exercise}\label{ex 11.6.4}
    Give examples to show that both directions of the integral test break down if \(f\) is not assumed to be monotone decreasing.
\end{exercise}

\begin{proof}
    Let \(f_1 : [0, \infty) \to \mathbf{R}\) be the function
    \[
        f_1(x) = \begin{cases}
            1 & \text{if } x \in \mathbf{N}    \\
            0 & \text{if } x \notin \mathbf{N}
        \end{cases}
    \]
    Then we know that \(f_1\) is not monotone decreasing and \(\sum_{n = 0}^\infty f_1(n)\) diverges.
    But \(\int_{[0, N]} f_1 = 0\) for all \(N \in \mathbf{N}\) and \(N > 0\), thus \(\sup_{N > 0} \int_{[0, N]} f_1\) is finite.

    Let \(f_2 : [0, \infty) \to \mathbf{R}\) be the function
    \[
        f_2(x) = \begin{cases}
            \frac{1}{x^2} & \text{if } x \in \mathbf{N}    \\
            \frac{1}{x}   & \text{if } x \notin \mathbf{N}
        \end{cases}
    \]
    Then we know that \(f_2\) is not monotone decreasing.
    By Corollary \ref{11.6.5} we know that \(\sup_{N > 0} \int_{[0, N]} \frac{1}{x}\) is not finite, and since \(\int_{[0, N]} f_2 = \int_{[0, N]} \frac{1}{x}\) we also have \(\sup_{N > 0} \int_{[0, N]} f_2\) is not finite.
    But by Corollary \ref{11.6.5} we know that \(\sum_{n = 0}^\infty \frac{1}{x^2}\) converges.
\end{proof}

\begin{exercise}\label{ex 11.6.5}
    Use Proposition \ref{11.6.4} to prove Corollary \ref{11.6.5}.
\end{exercise}

\begin{proof}
    See Corollary \ref{11.6.5}.
\end{proof}