\section{Rearrangement of series}\label{sec 7.4}

\begin{note}
    One feature of finite sums is that no matter how one rearranges the terms in a sequence, the total sum is the same.
    A more rigorous statement of this, involving bijections, has already appeared earlier, see Remark \ref{7.1.12}.
\end{note}

\begin{proposition}\label{7.4.1}
    Let \(\sum_{n = 0}^\infty a_n\) be a convergent series of non-negative real numbers, and let \(f : \mathbf{N} \to \mathbf{N}\) be a bijection.
    Then \(\sum_{m = 0}^\infty a_{f(m)}\) is also convergent, and has the same sum:
    \[
        \sum_{n = 0}^\infty a_n = \sum_{m = 0}^\infty a_{f(m)}.
    \]
\end{proposition}

\begin{proof}
    We introduce the partial sums \(S_N \coloneqq \sum_{n = 0}^N a_n\) and \(T_M \coloneqq \sum_{m = 0}^M a_{f(m)}\).
    We know that the sequences \((S_N)_{N = 0}^\infty\) and \((T_M)_{M = 0}^\infty\) are increasing.
    Write \(L \coloneqq \sup(S_N)_{N = 0}^\infty\) and \(L' \coloneqq \sup(T_M)_{M = 0}^\infty\).
    By Proposition \ref{6.3.8} we know that \(L\) is finite, and in fact \(L = \sum_{n = 0}^\infty a_n\);
    by Proposition \ref{6.3.8} again we see that we will thus be done as soon as we can show that \(L' = L\).

    Fix \(M\), and let \(Y\) be the set \(Y \coloneqq \{m \in \mathbf{N} : m \leq M\}\).
    Note that \(f\) is a bijection between \(Y\) and \(f(Y)\).
    By Proposition \ref{7.1.11}, we have
    \[
        T_M = \sum_{m = 0}^M a_{f(m)} = \sum_{m \in Y} a_{f(m)} = \sum_{n \in f(Y)} a_n.
    \]
    The sequence \((f(m))_{m = 0}^M\) is finite, hence bounded, i.e., there exists an \(N\) such that \(f(m) \leq N\) for all \(m \leq M\).
    In particular \(f(Y)\) is a subset of \(\{n \in \mathbf{N} : n \leq N\}\), and so by Proposition \ref{7.1.11} again (and the assumption that all the \(a_n\) are non-negative)
    \[
        T_M = \sum_{n \in f(Y)} a_n \leq \sum_{n \in \{n \in \mathbf{N} : n \leq N\}} a_n = \sum_{n = 0}^N a_n = S_N.
    \]
    But since \((S_N)_{N = 0}^\infty\) has a supremum of \(L\), we thus see that \(S_N \leq L\), and hence that \(T_M \leq L\) for all \(M\).
    Since \(L'\) is the least upper bound of \((T_M)_{M = 0}^\infty\), this implies that \(L' \leq L\).

    Now we fix \(N\), and let \(X\) be the set \(X \coloneqq \{n \in \mathbf{N} : n \leq N\}\).
    Note that \(f^{-1}\) is a bijection between \(X\) and \(f^{-1}(X)\).
    By Proposition \ref{7.1.11}, we have
    \[
        S_N = \sum_{n = 0}^N a_n = \sum_{n \in X} a_n = \sum_{m \in f^{-1}(X)} a_{f(m)}.
    \]
    The sequence \((f^{-1}(n))_{n = 0}^N\) is finite, hence bounded, i.e., there exists an \(M\) such that \(f^{-1}(n) \leq M\) for all \(n \leq N\).
    In particular \(f^{-1}(X)\) is a subset of \(\{m \in \mathbf{N} : m \leq M\}\), and so by Proposition \ref{7.1.11} again (and the assumption that all the \(a_n\) are non-negative)
    \[
        S_N = \sum_{m \in f^{-1}(X)} a_{f(m)} \leq \sum_{m \in \{m \in \mathbf{N} : m \leq M\}} a_{f(m)} = \sum_{m = 0}^M a_{f(m)} = T_M.
    \]
    But since \((T_M)_{M = 0}^\infty\) has a supremum of \(L'\), we thus see that \(T_M \leq L'\), and hence that \(S_N \leq L'\) for all \(N\).
    Since \(L\) is the least upper bound of \((S_N)_{N = 0}^\infty\), this implies that \(L \leq L'\).

    Combining these two inequalities we obtain \(L = L'\), as desired.
\end{proof}

\setcounter{theorem}{2}
\begin{proposition}[Rearrangement of series]\label{7.4.3}
    Let \(\sum_{n = 0}^\infty a_n\) be an absolutely convergent series of real numbers, and let \(f : \mathbf{N} \to \mathbf{N}\) be a bijection.
    Then \(\sum_{m = 0}^\infty a_{f(m)}\) is also absolutely convergent, and has the same sum:
    \[
        \sum_{n = 0}^\infty a_n = \sum_{m = 0}^\infty a_{f(m)}.
    \]
\end{proposition}

\begin{proof}
    We apply Proposition \ref{7.4.1} to the infinite series \(\sum_{n = 0}^\infty \abs*{a_n}\), which by hypothesis is a convergent series of non-negative numbers.
    If we write \(L \coloneqq \sum_{n = 0}^\infty \abs*{a_n}\), then by Proposition \ref{7.4.1} we know that \(\sum_{m = 0}^\infty \abs*{a_{f(m)}}\) also converges to \(L\).

    Now write \(L' \coloneqq \sum_{n = 0}^\infty a_n\).
    We have to show that \(\sum_{m = 0}^\infty a_{f(m)}\) also converges to \(L'\).
    In other words, given any \(\varepsilon > 0\), we have to find an \(M\) such that \(\sum_{m = 0}^{M'} a_{f(m)}\) is \(\varepsilon\)-close to \(L'\) for every \(M' \geq M\).

    Since \(\sum_{n = 0}^\infty \abs*{a_n}\) is convergent, we can use Proposition \ref{7.2.5} and find an \(N_1\) such that \(\sum_{n = p + 1}^q \abs*{a_n} \leq \varepsilon / 2\) for all \(p, q \geq N_1\).
    Since \(\sum_{n = 0}^\infty a_n\) converges to \(L'\), the partial sums \(\sum_{n = 0}^N a_n\) also converge to \(L'\), and so there exists \(N \geq N_1\) such that \(\sum_{n = 0}^N a_n\) is \(\varepsilon / 2\)-close to \(L'\).

    Now the sequence \((f^{-1}(n))_{n = 0}^N\) is finite, hence bounded, so there exists an \(M\) such that \(f^{-1}(n) \leq M\) for all \(0 \leq n \leq N\).
    In particular, for any \(M' \geq M\), the set \(\{f(m) : m \in \mathbf{N}; m \leq M'\}\) contains \(\{n \in \mathbf{N} : n \leq N\}\).
    So by Proposition \ref{7.1.11}, for any \(M' \geq M\),
    \[
        \sum_{m = 0}^{M'} a_{f(m)} = \sum_{n \in \{f(m) : m \in \mathbf{N}; m \leq M'\}} a_n = \sum_{n = 0}^N a_n + \sum_{n \in X} a_n
    \]
    where \(X\) is the set
    \[
        X = \{f(m) : m \in \mathbf{N}; m \leq M'\} \setminus \{n \in \mathbf{N} : n \leq N\}.
    \]
    The set \(X\) is finite, and is therefore bounded by some natural number \(q\);
    we must therefore have
    \[
        X \subseteq \{n \in \mathbf{N} : N + 1 \leq n \leq q\}.
    \]
    Thus
    \[
        \abs*{\sum_{n \in X} a_n} \leq \sum_{n \in X} \abs*{a_n} \leq \sum_{n = N + 1}^q \abs*{a_n} \leq \varepsilon / 2
    \]
    by our choice of \(N\).
    Thus \(\sum_{m = 0}^{M'} a_{f(m)}\) is \(\varepsilon / 2\)-close to \(\sum_{n = 0}^N a_n\), which as mentioned before is \(\varepsilon / 2\)-close to \(L'\).
    Thus \(\sum_{m = 0}^{M'} a_{f(m)}\) is \(\varepsilon\)-close to \(L'\) for all \(M' \geq M\), as desired.
\end{proof}

\begin{note}
    There is in fact a surprising result of Riemann, which shows that a series which is conditionally convergent but not absolutely convergent can in fact be rearranged to converge to \emph{any} value
    (or rearranged to diverge).
\end{note}

\begin{note}
    To summarize, rearranging series is safe when the series is absolutely convergent, but is somewhat dangerous otherwise.
    (This is not to say that rearranging a series that is not absolutely convergent necessarily gives you the wrong answer
    - for instance, in theoretical physics one often performs similar maneuvres, and one still (usually) obtains a correct answer at the end
    - but doing so is risky, unless it is backed by a rigorous result such as Proposition \ref{7.4.3}.)
\end{note}

\exercisesection

\begin{exercise}\label{ex 7.4.1}
    Let \(\sum_{n = 0}^\infty a_n\) be an absolutely convergent series of real numbers.
    Let \(f : \mathbf{N} \to \mathbf{N}\) be an increasing function (i.e., \(f(n + 1) > f(n)\) for all \(n \in \mathbf{N}\)).
    Show that \(\sum_{n = 0}^\infty a_{f(n)}\) is also an absolutely convergent series.
\end{exercise}

\begin{proof}
    Let \(S_N = \sum_{n = 0}^N \abs*{a_n}\) and \(T_N = \sum_{n = 0}^N \abs*{a_{f(n)}}\).
    Since \(\sum_{n = 0}^\infty a_n\) is absolutely convergent and \(S_N\) is an increasing sequence, by Proposition \ref{6.3.8} we have \(\lim_{N \to \infty} S_N = \sup(S_N)_{N = 0}^\infty\).
    Since \((f(n))_{n = 0}^N\) is a finite sequence, it is bounded by some \(M \in \mathbf{N}\), thus \(\{f(n) : n \in \mathbf{N} \land n \leq N\} \subseteq \{n \in \mathbf{N} : n \leq M\}\).
    Now we have
    \[
        T_N = \sum_{n = 0}^N \abs*{a_{f(n)}} = \sum_{n \in \{f(n) : n \in \mathbf{N} \land n \leq N\}} \abs*{a_n} \leq \sum_{n = 0}^M a_n = S_M \leq \sup(S_M)_{M = 0}^\infty = \lim_{M \to \infty} S_M,
    \]
    which means \(T_N\) is bounded.
    Since \((T_N)_{N = 0}^\infty\) is an increasing sequence and is bounded, by Proposition \ref{6.3.8} \((T_N)_{N = 0}^\infty\) converges, and thus \(\sum_{n = 0}^\infty a_{f(n)}\) is absolutely convergent.
\end{proof}