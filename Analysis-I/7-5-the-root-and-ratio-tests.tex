\section{The root and ratio tests}\label{sec 7.5}

\begin{theorem}[Root test]\label{7.5.1}
    Let \(\sum_{n = m}^\infty a_n\) be a series of real numbers, and let \(\alpha \coloneqq \limsup_{n \to \infty} \abs*{a_n}^{1 / n}\).
    \begin{enumerate}
        \item If \(\alpha < 1\), then the series \(\sum_{n = m}^\infty a_n\) is absolutely convergent
              (and hence conditionally convergent).
        \item If \(\alpha > 1\), then the series \(\sum_{n = m}^\infty a_n\) is not conditionally convergent
              (and hence cannot be absolutely convergent either).
        \item If \(\alpha = 1\), we cannot assert any conclusion.
    \end{enumerate}
\end{theorem}

\begin{proof}
    First suppose that \(\alpha < 1\).
    Note that we must have \(\alpha \geq 0\), since by Lemma \ref{5.6.6} \(\abs*{a_n}^{1 / n} \geq 0\) for every \(n\).
    Then we can find an \(\varepsilon > 0\) such that \(0 < \alpha + \varepsilon < 1\) (for instance, we can set \(\varepsilon \coloneqq (1 - \alpha) / 2\)).
    By Proposition \ref{6.4.12}(a), there exists an \(N \geq m\) such that \(\abs*{a_n}^{1 / n} \leq \alpha + \varepsilon\) for all \(n \geq N\).
    In other words, we have \(\abs*{a_n} \leq (\alpha + \varepsilon)^n\) for all \(n \geq N\).
    But from the geometric series (Lemma \ref{7.3.3}) we have that \(\sum_{n = N}^\infty (\alpha + \varepsilon)^n\) is absolutely convergent, since \(0 < \alpha + \varepsilon < 1\)
    (note that the fact that we start from \(N\) is irrelevant by Proposition \ref{7.2.14}(c)).
    Thus by the comparison test (Corollary \ref{7.3.2}), we see that \(\sum_{n = N}^\infty a_n\) is absolutely convergent, and thus \(\sum_{n = m}^\infty a_n\) is absolutely convergent, by Proposition \ref{7.2.14}(c) again.

    Now suppose that \(\alpha > 1\).
    Then by Proposition \ref{6.4.12}(b), we see that for every \(N \geq m\) there exists an \(n \geq N\) such that \(\abs*{a_n}^{1 / n} \geq 1\), and hence that \(\abs*{a_n} \geq 1\).
    In particular, \((a_n)_{n = N}^\infty\) is not \(1\)-close to \(0\) for any \(N\), and hence \((a_n)_{n = m}^\infty\) is not eventually \(1\)-close to \(0\).
    In particular, \((a_n)_{n = m}^\infty\) does not converge to zero.
    Thus by the zero test (Corollary \ref{7.2.6}), \(\sum_{n = m}^\infty a_n\) is not conditionally convergent.

    For \(\alpha = 1\), we show two sequences \((a_n)_{n = m}^\infty\) and \((b_n)_{n = m}^\infty\) where
    \[
        \limsup_{n \to \infty} \abs*{a_n}^{1 / n} = \limsup_{n \to \infty} \abs*{b_n}^{1 / n} = 1
    \]
    and
    \[
        \limsup_{n \to \infty} \frac{\abs*{a_{n + 1}}}{\abs*{a_n}} = \limsup_{n \to \infty} \frac{\abs*{b_{n + 1}}}{\abs*{b_n}} = 1
    \]
    but \(\sum_{n = m}^\infty a_n\) is convergent and \(\sum_{n = m}^\infty b_n\) is not.
    Let \(a_n = 1 / n\) and \(b_n = (-1)^n / n\).
    Then by Corollary \ref{7.3.7} \(\sum_{n = m}^\infty a_n\) is divergent, and by Alternating series test (Proposition \ref{7.2.12}) \(\sum_{n = m}^\infty b_n\) is convergent.
    By Lemma \ref{7.5.2}, we have
    \[
        \limsup_{n \to \infty} \abs*{\frac{1}{n}}^{1 / n} \leq \limsup_{n \to \infty} \frac{\abs*{n}}{\abs*{n + 1}} = \limsup_{n \to \infty} 1 - \frac{1}{n + 1} = 1
    \]
    by Proposition \ref{6.1.11} and limit laws (Theorem \ref{6.1.19}).
    Similarly we have
    \[
        \liminf_{n \to \infty} \abs*{\frac{1}{n}}^{1 / n} \geq \liminf_{n \to \infty} \frac{\abs*{n}}{\abs*{n + 1}} = \liminf_{n \to \infty} 1 - \frac{1}{n + 1} = 1.
    \]
    By Proposition \ref{6.4.12} we have
    \[
        \limsup_{n \to \infty} \frac{\abs*{n}}{\abs*{n + 1}} = \liminf_{n \to \infty} \frac{\abs*{n}}{\abs*{n + 1}} = \lim_{n \to \infty} \frac{\abs*{n}}{\abs*{n + 1}} = 1
    \]
    and
    \[
        \limsup_{n \to \infty} \abs*{\frac{1}{n}}^{1 / n} = \liminf_{n \to \infty} \abs*{\frac{1}{n}}^{1 / n} = \lim_{n \to \infty} \abs*{\frac{1}{n}}^{1 / n} = 1.
    \]
    So we have \(\limsup_{n \to \infty} \abs*{a_n}^{1 / n} = \limsup_{n \to \infty} \frac{\abs*{a_{n + 1}}}{\abs*{a_n}} = 1\) but \(\sum_{n = m}^\infty a_n\) is divergent.
    By Lemma \ref{7.5.2} again, we have
    \[
        \limsup_{n \to \infty} \abs*{\frac{(-1)^n}{n}}^{1 / n} \leq \limsup_{n \to \infty} \frac{\abs*{(-1)^n (n + 1)}}{\abs*{(-1)^{n + 1} n}} = \limsup_{n \to \infty} 1 - \frac{1}{n + 1} = 1
    \]
    by Proposition \ref{6.1.11} and limit laws (Theorem \ref{6.1.19}).
    Similarly we have
    \[
        \liminf_{n \to \infty} \abs*{\frac{(-1)^n}{n}}^{1 / n} \geq \liminf_{n \to \infty} \frac{\abs*{(-1)^n (n + 1)}}{\abs*{(-1)^{n + 1} n}} = \liminf_{n \to \infty} 1 - \frac{1}{n + 1} = 1
    \]
    By Proposition \ref{6.4.12} we have
    \[
        \limsup_{n \to \infty} \frac{\abs*{(-1)^n (n + 1)}}{\abs*{(-1)^{n + 1} n}} = \liminf_{n \to \infty} \frac{\abs*{(-1)^n (n + 1)}}{\abs*{(-1)^{n + 1} n}} = \lim_{n \to \infty} \frac{\abs*{(-1)^n (n + 1)}}{\abs*{(-1)^{n + 1} n}} = 1
    \]
    and
    \[
        \limsup_{n \to \infty} \abs*{\frac{(-1)^n}{n}}^{1 / n} = \liminf_{n \to \infty} \abs*{\frac{(-1)^n}{n}}^{1 / n} = \lim_{n \to \infty} \abs*{\frac{(-1)^n}{n}}^{1 / n} = 1.
    \]
    So we have \(\limsup_{n \to \infty} \abs*{b_n}^{1 / n} = \limsup_{n \to \infty} \frac{\abs*{b_{n + 1}}}{\abs*{b_n}} = 1\) but \(\sum_{n = m}^\infty b_n\) is convergent.
    Thus we conclude that when \(\limsup_{n \to \infty} \abs*{a_n}^{1 / n} = \limsup_{n \to \infty} \frac{\abs*{a_{n + 1}}}{\abs*{a_n}} = 1\) we cannot assert any conclusion.
\end{proof}

\begin{note}
    The root test is phrased using the limit superior, but of course if \(\lim_{n \to \infty} \abs*{a_n}^{1 / n}\) converges then the limit is the same as the limit superior.
    Thus one can phrase the root test using the limit instead of the limit superior, but \emph{only when the limit exists}.
\end{note}

\begin{lemma}\label{7.5.2}
    Let \((c_n)_{n = m}^\infty\) be a sequence of positive numbers.
    Then we have
    \[
        \liminf_{n \to \infty} \frac{c_{n + 1}}{c_n} \leq \liminf_{n \to \infty} c_n^{1 / n} \leq \limsup_{n \to \infty} c_n^{1 / n} \leq \limsup_{n \to \infty} \frac{c_{n + 1}}{c_n}.
    \]
\end{lemma}

\begin{proof}
    There are three inequalities to prove here.
    The middle inequality follows from Proposition \ref{6.4.12}(c).

    Next we show that \(\limsup_{n \to \infty} c_n^{1 / n} \leq \limsup_{n \to \infty} \frac{c_{n + 1}}{c_n}\).
    Write \(L \coloneqq \limsup_{n \to \infty} \frac{c_{n + 1}}{c_n}\).
    If \(L = +\infty\) then there is nothing to prove (since \(x \leq +\infty\) for every extended real number \(x\)), so we may assume that \(L\) is a finite real number.
    (Note that \(L\) cannot equal \(-\infty\)).
    Since \(\frac{c_{n + 1}}{c_n}\) is always positive, we know that \(L \geq 0\).

    Let \(\varepsilon > 0\).
    By Proposition \ref{6.4.12}(a), we know that there exists an \(N \geq m\) such that \(\frac{c_{n + 1}}{c_n} \leq L + \varepsilon\) for all \(n \geq N\).
    This implies that \(c_{n + 1} \leq c_n (L + \varepsilon)\) for all \(n \geq N\).
    By induction this implies that
    \[
        c_n \leq c_N (L + \varepsilon)^{n - N} \text{ for all } n \geq N.
    \]
    If we write \(A \coloneqq c_N (L + \varepsilon)^{-N}\), then we have
    \[
        c_n \leq A(L + \varepsilon)^n
    \]
    and thus
    \[
        c_n^{1 / n} \leq A^{1 / n} (L + \varepsilon)
    \]
    for all \(n \geq N\).
    But we have
    \[
        \lim_{n \to \infty} A^{1 / n} (L + \varepsilon) = L + \varepsilon
    \]
    by the limit laws (Theorem \ref{6.1.19}) and Lemma \ref{6.5.3}.
    Thus by the comparison principle (Lemma \ref{6.4.13}) we have
    \[
        \limsup_{n \to \infty} c_n^{1 / n} \leq L + \varepsilon.
    \]
    But this is true for all \(\varepsilon > 0\), so this must imply that
    \[
        \limsup_{n \to \infty} c_n^{1 / n} \leq L.
    \]
    (If \(L < \limsup_{n \to \infty} c_n^{1 / n}\), then when \(\varepsilon = (\limsup_{n \to \infty} c_n^{1 / n} - L) / 2\) we have
    \[
        \limsup_{n \to \infty} c_n^{1 / n} \leq \frac{\limsup_{n \to \infty} c_n^{1 / n} + L}{2},
    \]
    a contradiction.), as desired.

    Finally we show that \(\liminf_{n \to \infty} \frac{c_{n + 1}}{c_n} \leq \liminf_{n \to \infty} c_n^{1 / n}\).
    Write \(L \coloneqq \liminf_{n \to \infty} \frac{c_{n + 1}}{c_n}\).
    Since \(\frac{c_{n + 1}}{c_n}\) is always positive, we know that \(L \geq 0\).

    Let \(\varepsilon > 0\).
    By Proposition \ref{6.4.12}(a), we know that there exists an \(N \geq m\) such that \(\frac{c_{n + 1}}{c_n} \geq L - \varepsilon\) for all \(n \geq N\).
    This implies that \(c_{n + 1} \geq c_n (L - \varepsilon)\) for all \(n \geq N\).
    By induction this implies that
    \[
        c_n \geq c_N (L - \varepsilon)^{n - N} \text{ for all } n \geq N.
    \]
    If we write \(A \coloneqq c_N (L - \varepsilon)^{-N}\), then we have
    \[
        c_n \geq A(L - \varepsilon)^n
    \]
    and thus
    \[
        c_n^{1 / n} \geq A^{1 / n} (L - \varepsilon)
    \]
    for all \(n \geq N\).
    But we have
    \[
        \lim_{n \to \infty} A^{1 / n} (L - \varepsilon) = L - \varepsilon
    \]
    by the limit laws (Theorem \ref{6.1.19}) and Lemma \ref{6.5.3}.
    Thus by the comparison principle (Lemma \ref{6.4.13}) we have
    \[
        \liminf_{n \to \infty} c_n^{1 / n} \geq L - \varepsilon.
    \]
    But this is true for all \(\varepsilon > 0\), so this must imply that
    \[
        \liminf_{n \to \infty} c_n^{1 / n} \geq L.
    \]
    (If \(L > \liminf_{n \to \infty} c_n^{1 / n}\), then when \(\varepsilon = (L - \liminf_{n \to \infty} c_n^{1 / n}) / 2\) we have
    \[
        \liminf_{n \to \infty} c_n^{1 / n} \geq \frac{\liminf_{n \to \infty} c_n^{1 / n} + L}{2},
    \]
    a contradiction.), as desired.
\end{proof}

\begin{corollary}[Ratio test]\label{7.5.3}
    Let \(\sum_{n = m}^\infty a_n\) be a series of non-zero numbers.
    (The non-zero hypothesis is required so that the ratios \(\abs*{a_{n + 1}} / \abs*{a_n}\) appearing below are well-defined.)
    \begin{enumerate}
        \item If \(\limsup_{n \to \infty} \frac{\abs*{a_{n + 1}}}{\abs*{a_n}} < 1\), then the series \(\sum_{n = m}^\infty a_n\) is absolutely convergent (hence conditionally convergent).
        \item If \(\liminf_{n \to \infty} \frac{\abs*{a_{n + 1}}}{\abs*{a_n}} > 1\), then the series \(\sum_{n = m}^\infty a_n\) is not conditionally convergent (and thus cannot be absolutely convergent).
        \item In the remaining cases, we cannot assert any conclusion.
    \end{enumerate}
\end{corollary}

\begin{proof}
    We first show that if \(\limsup_{n \to \infty} \frac{\abs*{a_{n + 1}}}{\abs*{a_n}} < 1\), then the series \(\sum_{n = m}^\infty a_n\) is absolutely convergent.
    \begin{align*}
                 & \limsup_{n \to \infty} \frac{\abs*{a_{n + 1}}}{\abs*{a_n}} < 1                                                                                  \\
        \implies & \limsup_{n \to \infty} \abs*{a_n}^{1 / n} \leq \limsup_{n \to \infty} \frac{\abs*{a_{n + 1}}}{\abs*{a_n}} < 1 & \text{(by Lemma \ref{7.5.2})}   \\
        \implies & \sum_{n = m}^\infty a_n \text{ is absolutely convergent}.                                                     & \text{(by Theorem \ref{7.5.1})}
    \end{align*}

    Next we show that if \(\liminf_{n \to \infty} \frac{\abs*{a_{n + 1}}}{\abs*{a_n}} > 1\), then the series \(\sum_{n = m}^\infty a_n\) is not conditionally convergent.
    \begin{align*}
                 & \liminf_{n \to \infty} \frac{\abs*{a_{n + 1}}}{\abs*{a_n}} > 1                                                                                  \\
        \implies & \limsup_{n \to \infty} \abs*{a_n}^{1 / n} \geq \liminf_{n \to \infty} \frac{\abs*{a_{n + 1}}}{\abs*{a_n}} > 1 & \text{(by Lemma \ref{7.5.2})}   \\
        \implies & \sum_{n = m}^\infty a_n \text{ is not conditionally convergent}.                                              & \text{(by Theorem \ref{7.5.1})}
    \end{align*}

    Finally we show that if \(\liminf_{n \to \infty} \frac{\abs*{a_{n + 1}}}{\abs*{a_n}} \leq 1\) or \(\limsup_{n \to \infty} \frac{\abs*{a_{n + 1}}}{\abs*{a_n}} \geq 1\), then we cannot assert any conclusion.
    See Theorem \ref{7.5.1}.
\end{proof}

\begin{proposition}\label{7.5.4}
    We have \(\lim_{n \to \infty} n^{1 / n} = 1\).
\end{proposition}

\begin{proof}
    By Lemma \ref{7.5.2} we have
    \[
        \limsup_{n \to \infty} n^{1 / n} \leq \limsup_{n \to \infty} (n + 1) / n = \limsup_{n \to \infty} 1 + 1 / n = 1
    \]
    by Proposition \ref{6.1.11} and limit laws (Theorem \ref{6.1.19}).
    Similarly we have
    \[
        \liminf_{n \to \infty} n^{1 / n} \geq \liminf_{n \to \infty} (n + 1) / n = \liminf_{n \to \infty} 1 + 1 / n = 1.
    \]
    The claim then follows from Proposition \ref{6.4.12}(c) and (f).
\end{proof}

\begin{remark}\label{7.5.5}
    In addition to the ratio and root tests, another very useful convergence test is the \emph{integral test}.
\end{remark}

\exercisesection

\begin{exercise}\label{ex 7.5.1}
    Prove the first inequality in Lemma \ref{7.5.2}.
\end{exercise}

\begin{proof}
    See Lemma \ref{7.5.2}.
\end{proof}

\begin{exercise}\label{ex 7.5.2}
    Let \(x\) be a real number with \(\abs*{x} < 1\), and \(q\) be a real number.
    Show that the series \(\sum_{n = 1}^\infty n^q x^n\) is absolutely convergent, and that \(\lim_{n \to \infty} n^q x^n = 0\).
\end{exercise}

\begin{proof}
    Since \(q \in \mathbf{R}\), by Proposition \ref{5.4.12} \(\exists\ N \in \mathbf{N} \land N \geq q\).
    So
    \begin{align*}
                 & \forall\ n \geq 1 : \abs*{n^q x^n} \leq \abs*{n^N x^n}                                       & \text{(by Proposition \ref{5.6.9})} \\
        \implies & \forall\ n \geq 1 : \abs*{n^q x^n}^{1 / n} \leq \abs*{n^N x^n}^{1 / n}                       & \text{(by Proposition \ref{5.6.9})} \\
        \implies & \forall\ n \geq 1 : n^{q / n} \abs*{x} \leq n^{N / n} \abs*{x}                                                                     \\
        \implies & \limsup_{n \to \infty} n^{q / n} \abs*{x} \leq \limsup_{n \to \infty} n^{N / n} \abs*{x}     & \text{(by Lemma \ref{6.4.13})}      \\
        \implies & \limsup_{n \to \infty} n^{q / n} \abs*{x} \leq (\limsup_{n \to \infty} n^{1 / n})^N \abs*{x} & \text{(by Theorem \ref{6.1.19})}    \\
        \implies & \limsup_{n \to \infty} n^{q / n} \abs*{x} \leq 1^N \abs*{x}                                  & \text{(by Proposition \ref{7.5.4})} \\
        \implies & \limsup_{n \to \infty} n^{q / n} \abs*{x} \leq \abs*{x} < 1                                  & \text{(by the given condition)}     \\
        \implies & \sum_{n = 1}^\infty n^q x^n \text{ is absolutely convergent}.                                & \text{(by Theorem \ref{7.5.1})}
    \end{align*}
\end{proof}

\begin{exercise}\label{ex 7.5.3}
    Give an example of a divergent series \(\sum_{n = 1}^\infty a_n\) of positive numbers \(a_n\) such that \(\lim_{n \to \infty} a_{n + 1} / a_n = \lim_{n \to \infty} a_n^{1 / n} = 1\), and give an example of a convergent series \(\sum_{n = 1}^\infty b_n\) of positive numbers \(b_n\) such that \(\lim_{n \to \infty} b_{n + 1} / b_n = \lim_{n \to \infty} b_n^{1 / n} = 1\).
    This shows that the ratio and root tests can be inconclusive even when the summands are positive and all the limits converge.
\end{exercise}

\begin{proof}
    See Theorem \ref{7.5.1}.
\end{proof}