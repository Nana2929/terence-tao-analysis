\section{Real analytic functions}\label{sec 4.2}

\begin{definition}[Real analytic functions]\label{4.2.1}
    Let \(E\) be a subset of \(\mathbf{R}\), and let \(f : E \to \mathbf{R}\) be a function.
    If \(a\) is an interior point of \(E\), we say that \(f\) is \emph{real analytic at \(a\)} if there exists an open interval \((a - r, a + r)\) in \(E\) for some \(r > 0\) such that there exists a power series \(\sum_{n = 0}^\infty c_n (x - a)^n\) centered at \(a\) which has a radius of convergence greater than or equal to \(r\), and which converges to \(f\) on \((a - r, a + r)\).
    If \(E\) is an open set, and \(f\) is real analytic at every point \(a\) of \(E\), we say that \(f\) is \emph{real analytic on \(E\)}.
\end{definition}

\begin{example}\label{4.2.2}
    Consider the function \(f : \mathbf{R} \setminus \{1\} \to \mathbf{R}\) defined by \(f(x) \coloneqq \frac{1}{1 - x}\).
    This function is real analytic at \(0\) because we have a power series \(\sum_{n = 0}^\infty x^n\) centred at \(0\) which converges to \(\frac{1}{1 - x} = f(x)\) on the interval \((-1, 1)\).
    This function is also real analytic at \(2\) because we have a power series \(\sum_{n = 0}^\infty (-1)^{n + 1} (x - 2)^n\) which converges to \(\frac{-1}{1 - \big(-(x - 2)\big)} = \frac{1}{1 - x} = f(x)\) on the interval \((1, 3)\)
    (why? use Lemma 7.3.3 in Analysis I).
    In fact this function is real analytic on all of \(\mathbf{R} \setminus \{1\}\);
    see Exercise \ref{ex 4.2.2}.
\end{example}

\begin{remark}\label{4.2.3}
    The notion of being real analytic is closely related to another notion, that of being \emph{complex analytic}, but this is a topic for complex analysis, and will not be discussed here.
\end{remark}

\begin{note}
    From Theorem \ref{4.1.6}(c) and (d) we see that if \(f\) is real analytic at a point \(a\), then \(f\) is both continuous and diï¬€erentiable on \((a - r, a + r)\) for some \(r > 0\).
\end{note}

\begin{definition}[\(k\)-times differentiability]\label{4.2.4}
    Let \(E\) be a subset of \(\mathbf{R}\) with the property that every element of \(E\) is a limit point of \(E\).
    We say a function \(f : E \to \mathbf{R}\) is \emph{once differentiable on \(E\)} iff it is differentiable, in particular \(f': E \to \mathbf{R}\) is also a function on \(E\).
    More generally, for any \(k \geq 2\) we say that \(f : E \to \mathbf{R}\) is \emph{\(k\) times differentiable on \(E\)}, or just \emph{\(k\) times differentiable}, iff \(f\) is differentiable, and \(f'\) is \(k - 1\) times differentiable.
    If \(f\) is \(k\) times differentiable, we define the \(k^{\text{th}}\) derivative \(f^{(k)} : E \to \mathbf{R}\) by the recursive rule \(f^{(1)} \coloneqq f'\), and \(f^{(k)} = (f^{(k - 1)})'\) for all \(k \geq 2\).
    We also define \(f^{(0)} \coloneqq f\) (this is \(f\) differentiated \(0\) times), and we allow every function to be zero times differentiable (since clearly \(f^{(0)}\) exists for every \(f\)).
    A function is said to be \emph{infinitely differentiable} (or \emph{smooth}) iff it is \(k\) times differentiable for every \(k \geq 0\).
\end{definition}

\begin{additional corollary}\label{ac 4.2.1}
For each \(k \in \mathbf{N}\), we have
\[
    \lim_{n \to \infty} \bigg(\frac{(n + k)!}{n!}\bigg)^{\frac{1}{n}} = 1.
\]
\end{additional corollary}

\begin{proof}
    We use induction on \(k\).
    For \(k = 0\), we have
    \[
        \lim_{n \to \infty} \bigg(\frac{(n + 0)!}{n!}\bigg)^{\frac{1}{n}} = \lim_{n \to \infty} 1^{\frac{1}{n}} = \lim_{n \to \infty} 1 = 1.
    \]
    Thus the base case holds.
    Suppose inductively that
    \[
        \lim_{n \to \infty} \bigg(\frac{(n + k)!}{n!}\bigg)^{\frac{1}{n}} = 1
    \]
    for some \(k \geq 0\).
    We want to show that \(k + 1\) is also true.
    Observe that
    \begin{align*}
                 & \exists\ N \in \mathbf{Z}^+ : \forall\ n \geq N, Nn > k + 1                                                        \\
        \implies & \exists\ N \in \mathbf{Z}^+ : \forall\ n \geq N, (N + 1)n > n + k + 1                                              \\
        \implies & \exists\ N \in \mathbf{Z}^+ : \forall\ n \geq N, Nn > n + k + 1 > n                                                \\
        \implies & \exists\ N \in \mathbf{Z}^+ : \forall\ n \geq N, (Nn)^{\frac{1}{n}} > (n + k + 1)^{\frac{1}{n}} > n^{\frac{1}{n}}.
    \end{align*}
    Now we fix such \(N\).
    Since
    \begin{align*}
                 & \begin{cases}
            \lim_{n \to \infty} (Nn)^{\frac{1}{n}} = 1 & \text{(by Lemma 6.5.3 in Analysis I )} \\
            \lim_{n \to \infty} n^{\frac{1}{n}} = 1    & \text{(by Lemma 7.5.4 in Analysis I)}
        \end{cases}                                                     \\
        \implies & \lim_{n \to \infty} (n + k + 1)^{\frac{1}{n}} = 1, & \text{(by squeeze test)}
    \end{align*}
    we have
    \begin{align*}
                 & \lim_{n \to \infty} \bigg(\frac{(n + k)!}{n!}\bigg)^{\frac{1}{n}} = 1                                                                       & \text{(by induction hypothesis)} \\
        \implies & \Bigg(\lim_{n \to \infty} \bigg(\frac{(n + k)!}{n!}\bigg)^{\frac{1}{n}}\Bigg) \bigg(\lim_{n \to \infty} (n + k + 1)^{\frac{1}{n}}\bigg) = 1                                    \\
        \implies & \lim_{n \to \infty} \Bigg(\bigg(\frac{(n + k)!}{n!}\bigg)^{\frac{1}{n}} (n + k + 1)^{\frac{1}{n}}\Bigg) = 1                                                                    \\
        \implies & \lim_{n \to \infty} \bigg(\frac{(n + k + 1)!}{n!}\bigg)^{\frac{1}{n}} = 1.
    \end{align*}
    This closes the induction.
\end{proof}

\setcounter{theorem}{5}
\begin{proposition}[Real analytic functions are \(k\)-times differentiable]\label{4.2.6}
    Let \(E\) be a subset of \(\mathbf{R}\), let \(a\) be an interior point of \(E\), and and let \(f\) be a function which is real analytic at \(a\), thus there is an \(r > 0\) for which we have the power series expansion
    \[
        f(x) = \sum_{n = 0}^\infty c_n (x - a)^n
    \]
    for all \(x \in (a - r, a + r)\).
    Then for every \(k \geq 0\), the function \(f\) is \(k\)-times differentiable on \((a - r, a + r)\), and for each \(k \geq 0\) the \(k^{\text{th}}\) derivative is given by
    \begin{align*}
        f^{(k)}(x) & = \sum_{n = 0}^\infty c_{n + k} (n + 1) (n + 2) \dots (n + k) (x - a)^n \\
                   & = \sum_{n = 0}^\infty c_{n + k} \frac{(n + k)!}{n!} (x - a)^n
    \end{align*}
    for all \(x \in (a - r, a + r)\).
\end{proposition}

\begin{proof}
    Let \(R\) be the radius of convergence of \(f\).
    By Definition \ref{4.2.1} we know that \(r \leq R\) and thus
    \[
        \forall\ x \in (a - r, a + r), \abs*{x - a} < r \leq R.
    \]
    We use induction on \(k\).
    For \(k = 0\), by Definition \ref{4.2.4} we have
    \[
        \forall\ x \in (a - r, a + r), f^{(0)}(x) = f(x) = \sum_{n = 0}^\infty c_n (x - a)^n = \sum_{n = 0}^\infty c_{n + 0} \frac{(n + 0)!}{n!} (x - a)^n.
    \]
    Thus the base case holds.
    Suppose inductively that
    \[
        \forall\ x \in (a - r, a + r), f^{(k)}(x) = \sum_{n = 0}^\infty c_{n + k} \frac{(n + k)!}{n!} (x - a)^n
    \]
    for some \(k \geq 0\).
    By Additional Corollary \ref{ac 4.2.1} we know that
    \begin{align*}
                 & \limsup_{n \to \infty} \abs*{c_{n + k}}^{\frac{1}{n}} = \limsup_{n \to \infty} \abs*{c_n}^{\frac{1}{n}} = \frac{1}{R}                                            \\
        \implies & \Bigg(\limsup_{n \to \infty} \abs*{c_{n + k}}^{\frac{1}{n}}\Bigg) \Bigg(\limsup_{n \to \infty} \bigg(\frac{(n + k)!}{n!}\bigg)^{\frac{1}{n}}\Bigg) = \frac{1}{R} \\
        \implies & \limsup_{n \to \infty} \abs*{c_{n + k} \frac{(n + k)!}{n!}}^{\frac{1}{n}} = \frac{1}{R}.
    \end{align*}
    Thus by Theorem \ref{4.1.6}(b) we know that \(f^{(k)}(x)\) converges for all \(x \in (a - r, a + r)\).
    Now we define
    \[
        \forall\ n \in \mathbf{N}, b_n = c_{n + k} \frac{(n + k)!}{n!}.
    \]
    Then by Theorem \ref{4.1.6}(d) we have
    \begin{align*}
                 & \forall\ x \in (a - r, a + r), f^{(k)}(x) = \sum_{n = 0}^\infty c_{n + k} \frac{(n + k)!}{n!} (x - a)^n = \sum_{n = 0}^\infty b_n (x - a)^n                     \\
        \implies & \forall\ x \in (a - r, a + r), f^{(k + 1)}(x) = (f^{(k)})'(x) = \sum_{n = 1}^\infty n b_n (x - a)^{n - 1}                                                       \\
        \implies & \forall\ x \in (a - r, a + r), f^{(k + 1)}(x) = \sum_{n = 1}^\infty n c_{n + k} \frac{(n + k)!}{n!} (x - a)^{n - 1}                                             \\
        \implies & \forall\ x \in (a - r, a + r), f^{(k + 1)}(x) = \sum_{n = 1}^\infty c_{n + k} \frac{(n + k)!}{(n - 1)!} (x - a)^{n - 1}                                         \\
        \implies & \forall\ x \in (a - r, a + r), f^{(k + 1)}(x) = \sum_{n = 0}^\infty c_{(n + 1) + k} \frac{\big((n + 1) + k\big)!}{\big((n + 1) - 1\big)!} (x - a)^{(n + 1) - 1} \\
        \implies & \forall\ x \in (a - r, a + r), f^{(k + 1)}(x) = \sum_{n = 0}^\infty c_{n + k + 1} \frac{(n + k + 1)!}{n!} (x - a)^n
    \end{align*}
    and this closes the induction.
\end{proof}

\begin{corollary}[Real analytic functions are infinitely differentiable]\label{4.2.7}
    Let \(E\) be an open subset of \(\mathbf{R}\), and let \(f : E \to \mathbf{R}\) be a real analytic function on \(E\).
    Then \(f\) is infinitely differentiable on \(E\).
    Also, all derivatives of \(f\) are also real analytic on \(E\).
\end{corollary}

\begin{proof}
    For every point \(a \in E\) and \(k \geq 0\), we know from Proposition \ref{4.2.6} that \(f\) is \(k\)-times differentiable at \(a\)
    (we will have to apply Exercise 10.1.1 in Analysis I \(k\) times here).
    Thus \(f\) is \(k\)-times differentiable on \(E\) for every \(k \geq 0\) and is hence infinitely differentiable.
    Also, from Proposition \ref{4.2.6} we see that each derivative \(f^{(k)}\) of \(f\) has a convergent power series expansion at every \(x \in E\) and thus \(f^{(k)}\) is real analytic.
\end{proof}

\setcounter{theorem}{8}
\begin{remark}\label{4.2.9}
    The converse statement to Corollary \ref{4.2.7} is not true;
    there are infinitely differentiable functions which are not real analytic.
\end{remark}

\begin{note}
    Proposition \ref{4.2.6} has an important corollary (Corollary \ref{4.2.10}), due to Brook Taylor (1685 -- 1731).
\end{note}

\begin{corollary}[Taylor's formula]\label{4.2.10}
    Let \(E\) be a subset of \(\mathbf{R}\), let \(a\) be an interior point of \(E\), and let \(f : E \to \mathbf{R}\) be a function which is real analytic at \(a\) and has the power series expansion
    \[
        f(x) = \sum_{n = 0}^\infty c_n (x - a)^n
    \]
    for all \(x \in (a - r, a + r)\) and some \(r > 0\).
    Then for any integer \(k \geq 0\), we have
    \[
        f^{(k)}(a) = k! c_k,
    \]
    where \(k! \coloneqq 1 \times 2 \times \dots \times k\)
    (and we adopt the convention that \(0! = 1\)).
    In particular, we have Taylor's formula
    \[
        f(x) = \sum_{n = 0}^\infty \frac{f^{(n)}(a)}{n!} (x - a)^n
    \]
    for all \(x\) in \((a - r, a + r)\).
\end{corollary}

\begin{proof}
    We have
    \begin{align*}
        \forall\ k \in \mathbf{N}, f^{(k)}(a) & = \sum_{n = 0}^\infty c_{n + k} \frac{(n + k)!}{n!} (a - a)^n & \text{(by Proposition \ref{4.2.6})} \\
                                              & = c_k k!                                                      & (0^0 = 1)
    \end{align*}
    and thus
    \begin{align*}
        \forall\ x \in (a - r, a + r), f(x) & = \sum_{n = 0}^\infty c_n (x - a)^n                                                    \\
                                            & = \sum_{n = 0}^\infty \frac{c_n n!}{n!} (x - a)^n                                      \\
                                            & = \sum_{n = 0}^\infty \frac{f^{(n)}(a)}{n!} (x - a)^n. & \text{(from the proof above)}
    \end{align*}
\end{proof}

\begin{note}
    The power series \(\sum_{n = 0}^\infty \frac{f^{(n)}(a)}{n!} (x - a)^n\) is sometimes called the \emph{Taylor series} of \(f\) around \(a\).
    Taylor's formula thus asserts that if a function is real analytic, then it is equal to its Taylor series.
\end{note}

\begin{remark}\label{4.2.11}
    Note that Taylor's formula only works for functions which are real analytic;
    there are examples of functions which are infinitely differentiable but for which Taylor's theorem fails.
\end{remark}

\begin{corollary}[Uniqueness of power series]\label{4.2.12}
    Let \(E\) be a subset of \(\mathbf{R}\), let \(a\) be an interior point of \(E\), and let \(f : E \to \mathbf{R}\) be a function which is real analytic at \(a\).
    Suppose that \(f\) has two power series expansions
    \[
        f(x) = \sum_{n = 0}^\infty c_n (x - a)^n
    \]
    and
    \[
        f(x) = \sum_{n = 0}^\infty d_n (x - a)^n
    \]
    centered at \(a\), each with a non-zero radius of convergence.
    Then \(c_n = d_n\) for all \(n \geq 0\).
\end{corollary}

\begin{proof}
    By Corollary \ref{4.2.10}, we have \(f^{(k)}(a) = k! c_k\) for all \(k \geq 0\).
    But we also have \(f^{(k)}(a) = k! d_k\), by similar reasoning.
    Since \(k!\) is never zero, we can cancel it and obtain \(c_k = d_k\) for all \(k \geq 0\), as desired.
\end{proof}

\begin{remark}\label{4.2.13}
    While a real analytic function has a unique power series around any given point, it can certainly have different power series at different points.
    For instance, the function \(f(x) \coloneqq \frac{1}{1 - x}\), defined on \(\mathbf{R} \setminus \{1\}\), has the power series
    \[
        f(x) \coloneqq \sum_{n = 0}^\infty x^n
    \]
    around \(0\), on the interval \((-1, 1)\), but also has the power series
    \begin{align*}
        f(x) & = \frac{1}{1 - x}                                                  \\
             & = \frac{2}{1 - 2(x - \frac{1}{2})}                                 \\
             & = \sum_{n = 0}^\infty 2 \bigg(2\bigg(x - \frac{1}{2}\bigg)\bigg)^n \\
             & = \sum_{n = 0}^\infty 2^{n + 1} \bigg(x - \frac{1}{2}\bigg)^n
    \end{align*}
    around \(1 / 2\), on the interval \((0, 1)\)
    (note that the above power series has a radius of convergence of \(1 / 2\), thanks to the root test).
\end{remark}

\exercisesection

\begin{exercise}\label{ex 4.2.1}
    Let \(n \geq 0\) be an integer, let \(c, a\) be real numbers, and let \(f\) be the function \(f(x) \coloneqq c (x - a)^n\).
    Show that \(f\) is infinitely differentiable, and that \(f^{(k)}(x) = c \frac{n!}{(n - k)!} (x - a)^{n - k}\) for all integers \(0 \leq k \leq n\).
    What happens when \(k > n\)?
\end{exercise}

\begin{proof}
    For each \(n \in \mathbf{N}\), let \(P(n)\) be the statement ``If \(f(x) = c (x - a)^n\), then \(f^{(k)}(x) = c \frac{n!}{(n - k)!} (x - a)^{n - k}\) for all \(0 \leq k \leq n\)''.
    We use induction on \(n\) to show that \(P(n)\) is true for all \(n \in \mathbf{N}\).
    For \(n = 0\), we have \(0 \leq k \leq 0 \implies k = 0\).
    By Definition \ref{4.2.4} we have
    \[
        f^{(0)} = f = c (x - a)^0 = c = c \frac{0!}{(0 - 0)!} (x - a)^{0 - 0}
    \]
    and thus the base case holds.
    Suppose inductive that \(P(n)\) is true for some \(n \geq 0\).
    Then we want to show that \(P(n + 1)\) is true.
    Let \(f(x) = c (x - a)^{n + 1}\).
    Then we have
    \[
        f'(x) = c (n + 1) (x - a)^n.
    \]
    By induction hypothesis we know that
    \begin{align*}
                 & \frac{f'(x)}{n + 1} = c (x - a)^n                                                                                                            \\
        \implies & \forall\ 0 \leq k \leq n, \bigg(\frac{f'(x)}{n + 1}\bigg)^{(k)} = c \frac{n!}{(n - k)!} (x - a)^{n - k}                                      \\
        \implies & \forall\ 0 \leq k \leq n, \big(f'(x)\big)^{(k)} = c \frac{(n + 1)!}{(n - k)!} (x - a)^{n - k}                                                \\
        \implies & \forall\ 0 \leq k \leq n, f(x)^{(k + 1)} = c \frac{(n + 1)!}{(n - k)!} (x - a)^{n - k}                  & \text{(by Definition \ref{4.2.4})} \\
        \implies & \forall\ 1 \leq k \leq n + 1,                                                                                                                \\
                 & f(x)^{\big((k - 1) + 1\big)} = c \frac{(n + 1)!}{\big(n - (k - 1)\big)!} (x - a)^{n - (k - 1)}                                               \\
        \implies & \forall\ 1 \leq k \leq n + 1, f(x)^{(k)} = c \frac{(n + 1)!}{(n + 1 - k)!} (x - a)^{n + 1 - k}
    \end{align*}
    and we know that
    \[
        f(x)^{(0)} = f(x) = c (x - a)^{n + 1} = c \frac{(n + 1)!}{(n + 1 - 0)!} (x - a)^{n + 1 - 0}.
    \]
    Thus we have
    \[
        \forall\ 0 \leq k \leq n + 1, f(x)^{(k)} = c \frac{(n + 1)!}{(n + 1 - k)!} (x - a)^{n + 1 - k}
    \]
    and this closes the induction.

    Now let \(n \in \mathbf{N}\) and let \(f(x) = c (x - a)^n\).
    From the proof above we know that
    \[
        f^{(n)}(x) = c \frac{n!}{(n - n)!} (x - a)^{n - n} = c n!
    \]
    is a constant function.
    Thus we have
    \[
        \forall\ k > n, f^{(k)}(x) = 0
    \]
    and by Definition \ref{4.2.4} \(f\) is infinitely differentiable.
\end{proof}

\begin{exercise}\label{ex 4.2.2}
    Show that the function \(f\) defined in Example \ref{4.2.2} is real analytic on all of \(\mathbf{R} \setminus \{1\}\).
\end{exercise}

\begin{proof}
    Let \(a \in \mathbf{R} \setminus \{1\}\), let \(r = \abs*{1 - a}\), let \(x \in (a - r, a + r)\) and let \(c_n = (\frac{1}{1 - a})^{n + 1}\) for all \(n \in \mathbf{N}\).
    Then we have
    \begin{align*}
                 & a - r < x < a + r              \\
        \implies & \abs*{x - a} < r               \\
        \implies & \abs*{\frac{x - a}{1 - a}} < 1
    \end{align*}
    and by Lemma 7.3.3 in Analysis I we know that
    \begin{align*}
        \sum_{n = 0}^\infty c_n (x - a)^n & = \sum_{n = 0}^\infty \bigg(\frac{1}{1 - a}\bigg)^{n + 1} (x - a)^n     \\
                                          & = \frac{1}{1 - a} \sum_{n = 0}^\infty \bigg(\frac{x - a}{1 - a}\bigg)^n \\
                                          & = \frac{1}{1 - a} \frac{1}{1 - \frac{x - a}{1 - a}}                     \\
                                          & = \frac{1}{1 - x}.
    \end{align*}
    Since \(x\) is arbitrary, we know that \(\sum_{n = 0}^\infty c_n (x - a)^n\) converges to \(f\) on \((a - r, a + r)\).
    By Definition \ref{4.2.1} we know that \(f\) is real analytic at \(a\).
    Since \(a\) is arbitrary, by Definition \ref{4.2.1} we know that \(f\) is real analysis at \(a\) for each \(a \in \mathbf{R} \setminus \{1\}\).
\end{proof}

\begin{exercise}\label{ex 4.2.3}
    Prove Proposition \ref{4.2.6}.
\end{exercise}

\begin{proof}
    See Proposition \ref{4.2.6}.
\end{proof}

\begin{exercise}\label{ex 4.2.4}
    Use Proposition \ref{4.2.6} and Exercise \ref{ex 4.2.1} to prove Corollary \ref{4.2.10}.
\end{exercise}

\begin{proof}
    See Corollary \ref{4.2.10}.
\end{proof}

\begin{exercise}\label{ex 4.2.5}
    Let \(a, b\) be real numbers, and let \(n \geq 0\) be an integer.
    Prove the identity
    \[
        (x - a)^n = \sum_{m = 0}^n \frac{n!}{m! (n - m)!} (b - a)^{n - m} (x - b)^m
    \]
    or any real number \(x\).
    Explain why this identity is consistent with Taylor's theorem and Exercise \ref{ex 4.2.1}.
    (Note however that Taylor's theorem cannot be rigorously applied until one verifies Exercise \ref{ex 4.2.6} below.)
\end{exercise}

\begin{proof}
    Let \(f : \mathbf{R} \to \mathbf{R}\) be the function by setting \(f(x) = (x - a)^n\) for all \(x \in \mathbf{R}\).
    By Exercise 7.1.4 in Analysis I we have
    \begin{align*}
        \forall\ x \in \mathbf{R}, f(x) & = (x - a)^n                                                        \\
                                        & = (x - b + b - a)^n                                                \\
                                        & = \sum_{m = 0}^n \frac{n!}{m! (n - m)!} (x - b)^m (b - a)^{n - m}.
    \end{align*}
    If we define
    \[
        \forall\ m \in \mathbf{N}, c_m = \begin{cases}
            \frac{n! (b - a)^{n - m}}{m! (n - m)!} & \text{if } m \leq n \\
            0                                      & \text{if } m > n
        \end{cases}
    \]
    then we have
    \[
        \forall\ x \in \mathbf{R}, f(x) = \sum_{m = 0}^\infty c_m (x - b)^m = \sum_{m = 0}^n c_m (x - b)^m.
    \]
    Thus for arbitrary \(r \in \mathbf{R}^+\), \(\sum_{m = 0}^\infty c_m (x - b)^m\) converges to \(f(x)\) for all \(x \in (b - r, b + r)\).
    By Definition \ref{4.2.1} we know that \(f\) is real analytic at \(b\).
    By Corollary \ref{4.2.10} we have
    \begin{align*}
        \forall\ x \in \mathbf{R}, f(x) = \sum_{m = 0}^\infty \frac{f^{(m)}(b)}{m!} (x - b)^m.
    \end{align*}
    By Exercise \ref{ex 4.2.1} we have
    \[
        \forall\ m \in \mathbf{N}, \forall\ x \in \mathbf{R}, f^{(m)}(x) = \begin{cases}
            \frac{n!}{(n - m)!} (x - a)^{n - m} & \text{if } 0 \leq m \leq n \\
            0                                   & \text{if } m > n
        \end{cases}
    \]
    Thus
    \begin{align*}
        \forall\ x \in \mathbf{R}, f(x) & = \sum_{m = 0}^\infty \frac{f^{(m)}(b)}{m!} (x - b)^m              \\
                                        & = \sum_{m = 0}^n \frac{f^{(m)}(b)}{m!} (x - b)^m                   \\
                                        & = \sum_{m = 0}^n \frac{n!}{m! (n - m)!} (x - b)^m (b - a)^{n - m}.
    \end{align*}
\end{proof}

\begin{exercise}\label{ex 4.2.6}
    Using Exercise \ref{ex 4.2.5}, show that every polynomial \(P(x)\) of one variable is real analytic on \(\mathbf{R}\).
\end{exercise}

\begin{proof}
    Let \(P : \mathbf{R} \to \mathbf{R}\) be a polynomial with degree \(n\).
    First we show that \(P\) is real analytic at \(0\).
    By Definition \ref{3.8.1} we know that
    \[
        \forall\ x \in \mathbf{R}, P(x) = \sum_{i = 0}^n c_i x^i
    \]
    where \(c_0, \dots, c_n \in \mathbf{R}\) and \(c_n \neq 0\).
    If we define \(c_i = 0\) for all \(i > n\), then we have
    \[
        \forall\ x \in \mathbf{R}, \sum_{i = 0}^\infty c_i (x - 0)^i = \sum_{i = 0}^\infty c_i x^i = \sum_{i = 0}^n c_i x^i = P(x).
    \]
    Thus for arbitrary \(r \in \mathbf{R}^+\), \(\sum_{i = 0}^\infty c_i (x - 0)^i\) converges to \(P(x)\) for all \(x \in (-r, r)\).
    By Definition \ref{4.2.1} \(P\) is real analytic at \(0\).

    Now we show that \(P\) is real analytic at \(a \in \mathbf{R} \setminus \{0\}\).
    Since \(a \neq 0\), we have
    \begin{align*}
        \forall\ x \in \mathbf{R}, P(x) & = \sum_{i = 0}^n c_i x^i                                                                                                                         \\
                                        & = \sum_{i = 0}^n c_i \bigg(\sum_{m = 0}^i \frac{i!}{m! (i - m)!} a^{i - m} (x - a)^m\bigg)                 & \text{(by Exercise \ref{ex 4.2.5})} \\
                                        & = \sum_{i = 0}^n c_i \bigg(\sum_{m = 0}^i \frac{i!}{m! (i - m)!} a^{i - m} (x - a)^{m - i}\bigg) (x - a)^i
    \end{align*}
    If we define
    \[
        \forall\ i \in \mathbf{N}, d_i = \begin{cases}
            c_i \bigg(\sum_{m = 0}^i \frac{i!}{m! (i - m)!} a^{i - m} (x - a)^{m - i}\bigg) & \text{if } 0 \leq i \leq n \\
            0                                                                               & \text{if } i > n
        \end{cases}
    \]
    Then we have
    \[
        \forall\ x \in \mathbf{R}, \sum_{i = 0}^\infty d_i (x - a)^i = \sum_{i = 0}^n d_i (x - a)^i = P(x).
    \]
    Thus for arbitrary \(r \in \mathbf{R}^+\), \(\sum_{i = 0}^\infty d_i (x - a)^i\) converges to \(P(x)\) for all \(x \in (-r, r)\).
    By Definition \ref{4.2.1} \(P\) is real analytic at \(a\).
    Combine the proof above we conclude that \(P\) is real analytic on \(\mathbf{R}\).
    Since \(P\) is arbitrary, we conclude that polynomials of one variable are real analytic on \(\mathbf{R}\).
\end{proof}

\begin{exercise}\label{ex 4.2.7}
    Let \(m \geq 0\) be a positive integer, and let \(0 < x < r\) be real numbers.
    Use Lemma 7.3.3 in Analysis I to establish the identity
    \[
        \frac{r}{r - x} = \sum_{n = 0}^\infty x^n r^{-n}
    \]
    for all \(x \in (-r, r)\).
    Using Proposition \ref{4.2.6}, conclude the identity
    \[
        \frac{r}{(r - x)^{m + 1}} = \sum_{n = m}^\infty \frac{n!}{m! (n - m)!} x^{n - m} r^{-n}
    \]
    for all integers \(m \geq 0\) and \(x \in (-r, r)\).
    Also explain why the series on the right-hand side is absolutely convergent.
\end{exercise}

\begin{proof}
    By Lemma 7.3.3 in Analysis I we have
    \begin{align*}
                 & 0 < x < r                                                                                                                     \\
        \implies & \frac{x}{r} < 1                                                                                                               \\
        \implies & \sum_{n = 0}^\infty \bigg(\frac{x}{r}\bigg)^n = \sum_{n = 0}^\infty x^n r^{-n} = \frac{1}{1 - \frac{x}{r}} = \frac{r}{r - x}.
    \end{align*}
    Since
    \[
        x = 0 \implies \sum_{n = 0}^\infty 0^n r^{-n} = 0^0 r^{0} + \sum_{n = 1}^\infty 0^n r^{-n} = 1 = \frac{r}{r - 0},
    \]
    we know that
    \[
        \forall\ x \in (-r, r), \frac{r}{r - x} = \sum_{n = 0}^\infty x^n r^{-n}
    \]
    and by Definition \ref{4.2.1} \(x \mapsto \frac{r}{r - x}\) is real analytic at \(0\).

    Next we use induction on \(m\) to show that
    \[
        \forall\ m \in \mathbf{N}, \forall\ x \in (-r, r), \bigg(y \mapsto \frac{r}{r - y}\bigg)^{(m)}(x) = \frac{m! r}{(r - x)^{m + 1}}.
    \]
    For \(m = 0\), we have
    \[
        \forall\ x \in (-r, r), \bigg(y \mapsto \frac{r}{r - y}\bigg)^{(0)}(x) = \frac{r}{r - x} = \frac{0! r}{(r - x)^{0 + 1}}
    \]
    and thus the base case holds.
    Suppose inductively that
    \[
        \forall\ x \in (-r, r), \bigg(y \mapsto \frac{r}{r - y}\bigg)^{(m)}(x) = \frac{m! r}{(r - x)^{m + 1}}
    \]
    for some \(m \geq 0\).
    Then by Definition \ref{4.2.4} we have
    \[
        \forall\ x \in (-r, r), \bigg(y \mapsto \frac{r}{r - y}\bigg)^{(m + 1)}(x) = \bigg(\frac{m! r}{(r - x)^{m + 1}}\bigg)'(x) = \frac{(m + 1)! r}{(r - x)^{m + 2}}.
    \]
    This closes the induction.

    Now we show that
    \[
        \forall\ m \in \mathbf{N}, \frac{r}{(r - x)^{m + 1}} = \sum_{n = m}^\infty \frac{n!}{m! (n - m)!} x^{n - m} r^{-n}.
    \]
    From the proof above we know that
    \[
        \forall\ m \in \mathbf{N}, \forall\ x \in (-r, r), \frac{r}{(r - x)^{m + 1}} = \frac{1}{m!} \bigg(y \mapsto \frac{r}{r - y}\bigg)^{(m)}.
    \]
    By Proposition \ref{4.2.6} we know that
    \begin{align*}
        \forall\ m \in \mathbf{N}, \forall\ x \in (-r, r), & \bigg(y \mapsto \frac{r}{r - y}\bigg)^{(m)}                       \\
                                                           & = \sum_{n = 0}^\infty r^{-(n + m)} \frac{(n + m)!}{n!} x^n        \\
                                                           & = \sum_{n = m}^\infty r^{-n} \frac{n!}{(n - m)!} x^{n - m}        \\
                                                           & = m! \sum_{n = m}^\infty r^{-n} \frac{n!}{m! (n - m)!} x^{n - m}.
    \end{align*}
    Thus we have
    \[
        \forall\ m \in \mathbf{N}, \forall\ x \in (-r, r), \frac{r}{(r - x)^{m + 1}} = \sum_{n = m}^\infty r^{-n} \frac{n!}{m! (n - m)!} x^{n - m}.
    \]

    Since
    \begin{align*}
                 & \forall\ m \in \mathbf{N}, \lim_{n \to \infty} \bigg(\frac{(n + m)!}{n!}\bigg)^{\frac{1}{n}} = 1        & \text{(by Additional Corollary \ref{ac 4.2.1})} \\
        \implies & \forall\ m \in \mathbf{N}, \lim_{n \to \infty} \bigg(\frac{n!}{(n - m)!}\bigg)^{\frac{1}{n - m}} = 1                                                      \\
        \implies & \forall\ m \in \mathbf{N}, \lim_{n \to \infty} \bigg(\frac{n!}{(n - m)!}\bigg)^{\frac{1}{n}} = 1                                                          \\
        \implies & \forall\ m \in \mathbf{N}, \lim_{n \to \infty} \bigg(\frac{n!}{m! (n - m)!}\bigg)^{\frac{1}{n}} \leq 1,
    \end{align*}
    we have
    \begin{align*}
                 & \forall\ m \in \mathbf{N}, \limsup_{n \to \infty} \abs*{\bigg(\frac{n!}{m! (n - m)!}\bigg)^{\frac{1}{n}}} \leq 1                         \\
        \implies & \forall\ m \in \mathbf{N}, \limsup_{n \to \infty} \abs*{\bigg(\frac{n!}{m! (n - m)!}\bigg)^{\frac{1}{n}} \frac{x}{r}} < 1                \\
        \implies & \forall\ m \in \mathbf{N}, \limsup_{n \to \infty} \abs*{\bigg(\frac{n!}{m! (n - m)!}\bigg)^{\frac{1}{n}} (x^n r^{-n})^{\frac{1}{n}}} < 1
    \end{align*}
    and by root test
    \[
        \sum_{n = m}^\infty \frac{n!}{m! (n - m)!} x^n r^{-n}
    \]
    is absolutely converges, and so does
    \[
        x^{-m} \sum_{n = m}^\infty \frac{n!}{m! (n - m)!} x^n r^{-n} = \sum_{n = m}^\infty \frac{n!}{m! (n - m)!} x^{n - m} r^{-n}.
    \]
\end{proof}

\begin{exercise}\label{ex 4.2.8}
    Let \(E\) be a subset of \(\mathbf{R}\), let \(a\) be an interior point of \(E\), and let \(f : E \to \mathbf{R}\) be a function which is real analytic at \(a\), and has a power series expansion
    \[
        f(x) = \sum_{n = 0}^\infty c_n (x - a)^n
    \]
    at \(a\) which converges on the interval \((a - r, a + r)\).
    Let \((b - s, b + s)\) be any sub-interval of \((a - r, a + r)\) for some \(s > 0\).
    \begin{enumerate}
        \item Prove that \(\abs*{a - b} \leq r - s\), so in particular \(\abs*{a - b} < r\).
        \item Show that for every \(0 < \varepsilon < r\), there exists a \(C > 0\) such that \(\abs*{c_n} \leq C(r - \varepsilon)^{-n}\) for all integers \(n \geq 0\).
        \item Show that the numbers \(d_0, d_1, \dots\) given by the formula
              \[
                  d_m \coloneqq \sum_{n = m}^\infty \frac{n!}{m! (n - m)!} (b - a)^{n - m} c_n \text{ for all integers } m \geq 0
              \]
              are well-defined, in the sense that the above series is absolutely convergent.
        \item Show that for every \(0 < \varepsilon < s\) there exists a \(C > 0\) such that
              \[
                  \abs*{d_m} \leq C(s - \varepsilon)^{-m}
              \]
              for all integers \(m \geq 0\).
        \item Show that the power series \(\sum_{m = 0}^\infty d_m (x - b)^m\) is absolutely convergent for \(x \in (b - s, b + s)\) and converges to \(f(x)\).
        \item Conclude that \(f\) is real analytic at every point in \((a - r, a + r)\).
    \end{enumerate}
\end{exercise}