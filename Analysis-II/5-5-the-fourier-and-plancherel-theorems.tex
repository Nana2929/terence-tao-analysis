\section{The Fourier and Plancherel theorems}\label{sec 5.5}

\begin{theorem}[Fourier theorem]\label{5.5.1}
    For any \(f \in C(\mathbf{R} / \mathbf{Z} ; \mathbf{C})\), the series \(\sum_{n = -\infty}^\infty \hat{f}(n) e_n\) converges in \(L^2\) metric to \(f\).
    In other words, we have
    \[
        \lim_{N \to \infty} \norm*{f - \sum_{n = -N}^N \hat{f}(n) e_n}_2 = 0.
    \]
\end{theorem}

\begin{proof}
    Let \(\varepsilon > 0\).
    We have to show that there exists an \(N_0\) such that
    \[
        \norm*{f - \sum_{n = -N}^N \hat{f}(n) e_n}_2 \leq \varepsilon
    \]
    for all \(N \geq N_0\).

    By the Weierstrass approximation theorem (Theorem \ref{5.4.1}), we can find a trigonometric polynomial \(P = \sum_{n = -N_0}^{N_0} c_n e_n\) such that \(\norm*{f - P}_{\infty} \leq \varepsilon\), for some \(N_0 > 0\).
    In particular, we have \(\norm*{f - P}_2 \leq \varepsilon\) (Exercise \ref{ex 5.2.3}).

    Now let \(N > N_0\), and let \(F_N \coloneqq \sum_{n = -N}^N \hat{f}(n) e_n\).
    We claim that \(\norm*{f - F_N}_2 \leq \varepsilon\).
    First observe that for any \(\abs*{m} \leq N\), we have
    \[
        \inner*{f - F_N, e_m} = \inner*{f, e_m} - \sum_{n = -N}^N \hat{f}(n) \inner*{e_n, e_m} = \hat{f}(m) - \hat{f}(m) = 0,
    \]
    where we have used Lemma \ref{5.3.5} and Lemma \ref{5.2.5}.
    In particular we have
    \[
        \inner*{f - F_N, F_N - P} = 0
    \]
    since we can write \(F_N - P\) as a linear combination of the \(e_m\) for which \(\abs*{m} \leq N\).
    By Pythagoras' theorem (Lemma \ref{5.2.7}(d)) we therefore have
    \[
        \norm*{f - P}_2^2 = \norm*{f - F_N}_2^2 + \norm*{F_N - P}_2^2
    \]
    and in particular
    \[
        \norm*{f - F_N}_2 \leq \norm*{f - P}_2 \leq \varepsilon
    \]
    as desired.
\end{proof}

\begin{remark}\label{5.5.2}
    Note that we have only obtained convergence of the Fourier series \(\sum_{n = -\infty}^\infty \hat{f}(n) e_n\) to \(f\) in the \(L^2\) metric.
    One may ask whether one has convergence in the uniform or pointwise sense as well, but it turns out (perhaps somewhat surprisingly) that the answer is no to both of those questions.
    However, if one assumes that the function \(f\) is not only continuous, but is also differentiable, then one can recover pointwise convergence;
    if one assumes continuously differentiable, then one gets uniform convergence as well.
    These results are beyond the scope of this text and will not be proven here.
    However, we will prove one theorem about when one can improve the \(L^2\) convergence to uniform convergence.
\end{remark}

\begin{theorem}\label{5.5.3}
    Let \(f \in C(\mathbf{R} / \mathbf{Z} ; \mathbf{C})\), and suppose that the series \(\sum_{n = -\infty}^\infty \abs*{\hat{f}(n)}\) is absolutely convergent.
    Then the series \(\sum_{n = -\infty}^\infty \hat{f}(n) e_n\) converges uniformly to \(f\).
    In other words, we have
    \[
        \lim_{N \to \infty} \norm*{f - \sum_{n = -N}^N \hat{f}(n) e_n}_{\infty} = 0.
    \]
\end{theorem}

\begin{proof}
    By the Weierstrass \(M\)-test (Theorem \ref{3.5.7}), we see that \(\sum_{n = -\infty}^\infty \hat{f}(n) e_n\) converges to some function \(F\), which by Lemma \ref{5.1.5}(c) is also continuous and \(\mathbf{Z}\)-periodic.
    (Strictly speaking, the Weierstrass \(M\)-test was phrased for series from \(n = 1\) to \(n = +\infty\), but also works for series from \(n = -\infty\) to \(n = +\infty\);
    this can be seen by splitting the doubly infinite series into two pieces.)
    Thus
    \[
        \lim_{N \to \infty} \norm*{F - \sum_{n = -N}^N \hat{f}(n) e_n}_{\infty} = 0
    \]
    which implies that
    \[
        \lim_{N \to \infty} \norm*{F - \sum_{n = -N}^N \hat{f}(n) e_n}_2 = 0
    \]
    since the \(L^2\) norm is always less than or equal to the \(L^\infty\) norm (Exercise \ref{ex 5.2.3}).
    But the sequence \(\sum_{n = -N}^N \hat{f}(n) e_n\) is already converging in \(L^2\) metric to \(f\) by the Fourier theorem (Theorem \ref{5.5.1}), so can only converge in \(L^2\) metric to \(F\) if \(F = f\)
    (cf. Proposition \ref{1.1.20}).
    Thus \(F = f\), and so we have
    \[
        \lim_{N \to \infty} \norm*{f - \sum_{n = -N}^N \hat{f}(n) e_n}_{\infty} = 0
    \]
    as desired.
\end{proof}

\begin{theorem}[Plancherel theorem]\label{5.5.4}
    For any \(f \in C(\mathbf{R} / \mathbf{Z} ; \mathbf{C})\), the series
    \[
        \sum_{n = -\infty}^\infty \abs*{\hat{f}(n)}^2
    \]
    is absolutely convergent, and
    \[
        \norm*{f}_2^2 = \sum_{n = -\infty}^\infty \abs*{\hat{f}(n)}^2.
    \]
\end{theorem}

\begin{proof}
    Let \(\varepsilon > 0\).
    By the Fourier theorem (Theorem \ref{5.5.1}) we know that
    \[
        \norm*{f - \sum_{n = -N}^N \hat{f}(n) e_n}_2 \leq \varepsilon
    \]
    if \(N\) is large enough (depending on \(\varepsilon\)).
    In particular, by the triangle inequality (Lemma \ref{5.2.7}(c)(e)) this implies that
    \[
        \norm*{f}_2 - \varepsilon \leq \norm*{\sum_{n = -N}^N \hat{f}(n) e_n}_2 \leq \norm*{f}_2 + \varepsilon.
    \]
    On the other hand, by Corollary \ref{5.3.6} we have
    \[
        \norm*{\sum_{n = -N}^N \hat{f}(n) e_n}_2 = \bigg(\sum_{n = -N}^N \abs*{\hat{f}(n)}^2\bigg)^{1 / 2}
    \]
    and hence
    \[
        (\norm*{f}_2 - \varepsilon)^2 \leq \sum_{n = -N}^N \abs*{\hat{f}(n)}^2 \leq (\norm*{f}_2 + \varepsilon)^2.
    \]
    Taking \(\limsup\), we obtain
    \[
        (\norm*{f}_2 - \varepsilon)^2 \leq \limsup_{N \to \infty} \sum_{n = -N}^N \abs*{\hat{f}(n)}^2 \leq (\norm*{f}_2 + \varepsilon)^2.
    \]
    Since \(\varepsilon\) is arbitrary, we thus obtain by the squeeze test that
    \[
        \limsup_{N \to \infty} \sum_{n = -N}^N \abs*{\hat{f}(n)}^2 = \norm*{f}_2^2
    \]
    and the claim follows.
\end{proof}

\begin{note}
    Theorem \ref{5.5.4} is also known as \emph{Parseval's theorem}.
\end{note}

\exercisesection

\begin{exercise}\label{ex 5.5.1}
    Let \(f\) be a function in \(C(\mathbf{R} / \mathbf{Z} ; \mathbf{C})\), and define the \emph{trigonometric Fourier coefficients} \(a_n, b_n\) for \(n = 0, 1, 2, 3, \dots\) by
    \[
        a_n = 2 \int_{[0, 1]} f(x) \cos(2 \pi n x) \; dx; \quad b_n = 2 \int_{[0, 1]} f(x) \sin(2 \pi n x) \; dx.
    \]
    \begin{enumerate}
        \item Show that the series
              \[
                  \frac{1}{2} a_0 + \sum_{n = 1}^\infty \big(a_n \cos(2 \pi n x) + b_n \sin(2 \pi n x)\big)
              \]
              converges in \(L_2\) metric to \(f\).
        \item Show that if \(\sum_{n = 1}^\infty a_n\) and \(\sum_{n = 1}^\infty b_n\) are absolutely convergent, then the above series actually converges uniformly to \(f\), and not just in \(L_2\) metric.
    \end{enumerate}
\end{exercise}

\begin{proof}{(a)}
    Observe that for all \(n \in \mathbf{Z}\), we have
    \begin{align*}
         & \hat{f}(n)                                                                                                                                              \\
         & = \int_{[0, 1]} f(x) e^{- 2 \pi i n x} \; dx                                                                       & \text{(by Definition \ref{5.3.7})} \\
         & = \int_{[0, 1]} f(x) \big(\cos(2 \pi n x) - i \sin(2 \pi n x)\big) \; dx                                           & \text{(by Theorem \ref{4.7.2}(f))} \\
         & = \int_{[0, 1]} f(x) \cos(2 \pi n x) \; dx - i \int_{[0, 1]} f(x) \sin(2 \pi n x) \; dx                            & \text{(by Remark \ref{5.2.2})}     \\
         & = \frac{1}{2} \bigg(2 \int_{[0, 1]} f(x) \cos(2 \pi n x) \; dx - 2i \int_{[0, 1]} f(x) \sin(2 \pi n x) \; dx\bigg)                                      \\
         & = \frac{1}{2} (a_n - i b_n)
    \end{align*}
    and
    \begin{align*}
         & \hat{f}(-n)                                                                                                                                             \\
         & = \frac{1}{2} (a_{-n} - i b_{-n})                                                                                  & \text{(from the proof above)}      \\
         & = \frac{1}{2} \bigg(2 \int_{[0, 1]} f(x) \cos(- 2 \pi n x) \; dx                                                                                        \\
         & \quad - 2i \int_{[0, 1]} f(x) \sin(- 2 \pi n x) \; dx\bigg)                                                                                             \\
         & = \frac{1}{2} \bigg(2 \int_{[0, 1]} f(x) \cos(2 \pi n x) \; dx                                                                                          \\
         & \quad - 2i \int_{[0, 1]} -f(x) \sin(2 \pi n x) \; dx\bigg)                                                         & \text{(by Theorem \ref{4.7.2}(c))} \\
         & = \frac{1}{2} \bigg(2 \int_{[0, 1]} f(x) \cos(2 \pi n x) \; dx + 2i \int_{[0, 1]} f(x) \sin(2 \pi n x) \; dx\bigg) & \text{(by Remark \ref{5.2.2})}     \\
         & = \frac{1}{2} (a_n + i b_n).
    \end{align*}
    By Fourier theroem (Theorem \ref{5.5.1}) we know that
    \[
        \lim_{N \to \infty} \norm*{f - \sum_{n = -N}^N \hat{f}(n) e_n}_2 = 0.
    \]
    Since for all \(N \in \mathbf{Z}^+\), we have
    \begin{align*}
         & \sum_{n = -N}^N \hat{f}(n) e_n                                                                                                                                  \\
         & = \hat{f}(0) e_0 + \sum_{n = 1}^N \hat{f}(n) e_n + \sum_{n = -N}^{-1} \hat{f}(n) e_n                                                                            \\
         & = \hat{f}(0) e_0 + \sum_{n = 1}^N \hat{f}(n) e_n + \sum_{n = 1}^N \hat{f}(-n) e_{-n}                                                                            \\
         & = \frac{(a_0 - i b_0) e_0}{2} + \sum_{n = 1}^N \frac{(a_n - i b_n) e_n}{2} + \sum_{n = 1}^N \frac{(a_n + i b_n) e_{-n}}{2} & \text{(from the proof above)}      \\
         & = \frac{a_0 e_0}{2} + \sum_{n = 1}^N \frac{(a_n - i b_n) e_n}{2} + \sum_{n = 1}^N \frac{(a_n + i b_n) e_{-n}}{2}           & \text{(by Theorem \ref{4.7.2}(e))} \\
         & = \frac{a_0}{2} + \sum_{n = 1}^N \frac{(a_n - i b_n) e_n}{2} + \sum_{n = 1}^N \frac{(a_n + i b_n) e_{-n}}{2}               & \text{(by Theorem \ref{4.5.2}(e))} \\
         & = \frac{a_0}{2} + \sum_{n = 1}^N \frac{a_n (e_n + e_{-n}) - i b_n (e_n - e_{-n})}{2}                                       & \text{(by Lemma \ref{4.6.6})}      \\
         & = \frac{a_0}{2} + \sum_{n = 1}^N a_n \cos(2 \pi n x) + b_n \sin(2 \pi n x),                                                & \text{(by Definition \ref{4.7.1})}
    \end{align*}
    we know that
    \[
        \lim_{N \to \infty} \norm*{f - \bigg(\frac{a_0}{2} + \sum_{n = 1}^N a_n \cos(2 \pi n x) + b_n \sin(2 \pi n x)\bigg)}_2 = 0.
    \]
    Thus by Definition \ref{1.1.14} we have
    \begin{align*}
         & d_{L^2} - \lim_{N \to \infty} \bigg(\frac{a_0}{2} + \sum_{n = 1}^N a_n \cos(2 \pi n x) + b_n \sin(2 \pi n x)\bigg) \\
         & = \frac{a_0}{2} + \sum_{n = 1}^\infty a_n \cos(2 \pi n x) + b_n \sin(2 \pi n x)                                    \\
         & = f.
    \end{align*}
\end{proof}

\begin{proof}{(b)}
    Observe that
    \begin{align*}
         & \frac{a_0}{2} + \sum_{n = 1}^\infty \abs*{a_n} + \sum_{n = 1}^\infty \abs*{b_n}                                                             & \text{(by hypothesis)}                          \\
         & = \frac{a_0}{2} + \lim_{N \to \infty} \sum_{n = 1}^N \abs*{a_n} + \lim_{N \to \infty} \sum_{n = 1}^N \abs*{b_n}                             & \text{(by Additional Corollary \ref{ac 4.6.6})} \\
         & = \frac{a_0}{2} + \lim_{N \to \infty} \sum_{n = 1}^N \abs*{a_n} + \abs*{b_n}                                                                & \text{(by Lemma \ref{4.6.14})}                  \\
         & = \frac{a_0}{2} + 2 \bigg(\lim_{N \to \infty} \sum_{n = 1}^N \frac{\abs*{a_n} + \abs*{b_n}}{2}\bigg)                                        & \text{(by Lemma \ref{4.6.14})}                  \\
         & = \frac{a_0}{2} + 2 \sum_{n = 1}^\infty \frac{\abs*{a_n} + \abs*{b_n}}{2}                                                                   & \text{(by Additional Corollary \ref{ac 4.6.6})} \\
         & = \frac{a_0}{2} + \sum_{n = 1}^\infty \frac{\abs*{a_n} + \abs*{b_n}}{2} + \sum_{n = 1}^\infty \frac{\abs*{a_n} + \abs*{b_n}}{2}                                                               \\
         & = \frac{a_0}{2} + \sum_{n = 1}^\infty \frac{\abs*{a_n} + \abs*{i b_n}}{2} + \sum_{n = 1}^\infty \frac{\abs*{a_n} + \abs*{-i b_n}}{2}        & \text{(by Lemma \ref{4.6.11})}                  \\
         & \geq \frac{a_0}{2} + \sum_{n = 1}^\infty \frac{\abs*{a_n + i b_n}}{2} + \sum_{n = 1}^\infty \frac{\abs*{a_n - i b_n}}{2}                    & \text{(by Lemma \ref{4.6.11})}                  \\
         & = \frac{a_0}{2} + \sum_{n = 1}^\infty \frac{\abs*{a_{-n} - i b_{-n}}}{2} + \sum_{n = 1}^\infty \frac{\abs*{a_n - i b_n}}{2}                 & \text{(by Theorem \ref{4.7.2}(c))}              \\
         & = \frac{a_0}{2} + \sum_{n = 1}^\infty \frac{\abs*{a_{-n} - i b_{-n}}}{2} + \sum_{n = 1}^\infty \frac{\abs*{a_n - i b_n}}{2}                 & \text{(by Theorem \ref{4.7.2}(e))}              \\
         & = \lim_{N \to \infty} \frac{a_0}{2} + \sum_{n = 1}^N \frac{\abs*{a_{-n} - i b_{-n}}}{2} + \sum_{n = 1}^N \frac{\abs*{a_n - i b_n}}{2}       & \text{(by Lemma \ref{4.6.14})}                  \\
         & = \lim_{N \to \infty} \frac{a_0}{2} + \sum_{n = -N}^{-1} \frac{\abs*{a_n - i b_n}}{2} + \sum_{n = 1}^N \frac{\abs*{a_n - i b_n}}{2}                                                           \\
         & = \lim_{N \to \infty} \frac{a_0 - i b_0}{2} + \sum_{n = -N}^{-1} \frac{\abs*{a_n - i b_n}}{2} + \sum_{n = 1}^N \frac{\abs*{a_n - i b_n}}{2} & \text{(by Theorem \ref{4.7.2}(e))}              \\
         & = \lim_{N \to \infty} \sum_{n = -N}^N \frac{\abs*{a_{-n} - i b_{-n}}}{2}                                                                                                                      \\
         & = \sum_{n = -\infty}^\infty \frac{\abs*{a_{-n} - i b_{-n}}}{2}.
    \end{align*}
    Since
    \[
        \hat{f}(n) = \frac{1}{2} (a_n - i b_n)
    \]
    for all \(n \in \mathbf{Z}\) (cf. the proof of Exercise \ref{ex 5.5.1}(a)), we know that
    \begin{align*}
        \sum_{n = -\infty}^\infty \abs*{\hat{f}(n)} & = \sum_{n = -\infty}^\infty \abs*{\frac{a_n - i b_n}{2}}                                                                    \\
                                                    & = \sum_{n = -\infty}^\infty \frac{\abs*{a_n - i b_n}}{2}                              & \text{(by Exercise \ref{ex 4.6.7})} \\
                                                    & \leq \frac{a_0}{2} + \sum_{n = 1}^\infty \abs*{a_n} + \sum_{n = 1}^\infty \abs*{b_n}. & \text{(from the proof above)}
    \end{align*}
    Thus \(\sum_{n = -\infty}^\infty \abs*{\hat{f}(n)}\) is absolutely convergent.
    By Theorem \ref{5.5.3} we know that
    \[
        \lim_{N \to \infty} \norm*{f - \sum_{n = -N}^N \hat{f}(n) e_n}_{\infty} = 0.
    \]
    and \(\sum_{n = -\infty}^\infty \hat{f}(n) e_n\) converges uniformly to \(f\) on \(\mathbf{R}\) with respect to \(d_{l^1}|_{\mathbf{C} \times \mathbf{C}}\).
    In particular, we have (by Exercise \ref{ex 5.2.3} and squeeze test)
    \[
        \lim_{N \to \infty} \norm*{f - \sum_{n = -N}^N \hat{f}(n) e_n}_2 = 0.
    \]
    By Exercise \ref{ex 5.5.1}(a) we know that
    \[
        \lim_{N \to \infty} \norm*{f - \bigg(\frac{a_0}{2} + \sum_{n = 1}^N a_n \cos(2 \pi n x) + b_n \sin(2 \pi n x)\bigg)}_2 = 0.
    \]
    Thus by Proposition \ref{1.1.20} we have
    \[
        \lim_{N \to \infty} \norm*{f - \bigg(\frac{a_0}{2} + \sum_{n = 1}^N a_n \cos(2 \pi n x) + b_n \sin(2 \pi n x)\bigg)}_{\infty} = 0.
    \]
    and \(\frac{a_0}{2} + \sum_{n = 1}^\infty a_n \cos(2 \pi n x) + b_n \sin(2 \pi n x)\) converges uniformly to \(f\) on \(\mathbf{R}\) with respect to \(d_{l^1}|_{\mathbf{C} \times \mathbf{C}}\).
\end{proof}

\begin{exercise}\label{ex 5.5.2}
    Let \(f(x)\) be the function defined by \(f(x) = (1 - 2x)^2\) when \(x \in [0, 1)\), and extended to be \(\mathbf{Z}\)-periodic for the rest of the real line.
    \begin{enumerate}
        \item Using Exercise \ref{ex 5.5.1}, show that the series
              \[
                  \frac{1}{3} + \sum_{n = 1}^\infty \frac{4}{\pi^2 n^2} \cos(2 \pi n x)
              \]
              converges uniformly to \(f\) .
        \item Conclude that \(\sum_{n = 1}^\infty \frac{1}{n^2} = \frac{\pi^2}{6}\).
        \item Conclude that \(\sum_{n = 1}^\infty \frac{1}{n^4} = \frac{\pi^4}{90}\).
    \end{enumerate}
\end{exercise}

\begin{exercise}\label{ex 5.5.3}
    If \(f \in C(\mathbf{R} / \mathbf{Z} ; \mathbf{C})\) and \(P\) is a trigonometric polynomial, show that
    \[
        \hat{f * P}(n) = \hat{f}(n) c_n = \hat{f}(n) \hat{P}(n)
    \]
    for all integers \(n\).
    More generally, if \(f, g \in C(\mathbf{R} / \mathbf{Z} ; \mathbf{C})\), show that
    \[
        \hat{f * g}(n) = \hat{f}(n) \hat{g}(n)
    \]
    for all integers \(n\).
    (A fancy way of saying this is that the Fourier transform \emph{intertwines} convolution and multiplication.)
\end{exercise}

\begin{exercise}\label{ex 5.5.4}
    Let \(f \in C(\mathbf{R} / \mathbf{Z} ; \mathbf{C})\) be a function which is differentiable, and whose derivative \(f'\) is also continuous.
    Show that \(f'\) also lies in \(C(\mathbf{R} / \mathbf{Z} ; \mathbf{C})\), and that \(\hat{f}'(n) = 2 \pi i n \hat{f}(n)\) for all integers \(n\).
    Here the derivative of a complex-valued function is defined in exactly the same fashion as for real-valued functions.
\end{exercise}

\begin{exercise}\label{ex 5.5.5}
    Let \(f, g \in C(\mathbf{R} / \mathbf{Z} ; \mathbf{C})\).
    Prove the \emph{Parseval identity}
    \[
        \Re\bigg(\int_0^1 f(x) \overline{g(x)} \; dx\bigg) = \Re\bigg(\sum_{n \in \mathbf{Z}} \hat{f}(n) \overline{\hat(g)(n)}\bigg).
    \]
    Then conclude that the real parts can be removed, thus
    \[
        \int_0^1 f(x) \overline{g(x)} \; dx = \sum_{n \in \mathbf{Z}} \hat{f}(n) \overline{\hat(g)(n)}.
    \]
\end{exercise}

\begin{exercise}\label{ex 5.5.6}
    In this exercise we shall develop the theory of Fourier series for functions of any fixed period \(L\).

    Let \(L > 0\), and let \(f : \mathbf{R} \to \mathbf{C}\) be a complex-valued function which is continuous and \(L\)-periodic.
    Define the numbers \(c_n\) for every integer \(n\) by
    \[
        c_n \coloneqq \frac{1}{L} \int_{[0, L]} f(x) e^{- 2 \pi i n x / L} \; dx.
    \]
    \begin{enumerate}
        \item Show that the series
              \[
                  \sum_{n = -\infty}^\infty c_n e^{2 \pi i n x / L}
              \]
              converges in \(L_2\) metric to \(f\).
              More precisely, show that
              \[
                  \lim_{N \to \infty} \int_{[0, L]} \abs*{f(x) - \sum_{n = -N}^N c_n e^{2 \pi i n x / L}}^2 \; dx = 0.
              \]
        \item If the series \(\sum_{n = -\infty}^\infty \abs*{c_n}\) is absolutely convergent, show that
              \[
                  \sum_{n = -\infty}^\infty c_n e^{2 \pi i n x / L}
              \]
              converges uniformly to \(f\).
        \item Show that
              \[
                  \frac{1}{L} \int_{[0, L]} \abs*{f(x)}^2 \; dx = \sum_{n = -\infty}^\infty \abs*{c_n}^2.
              \]
    \end{enumerate}
\end{exercise}